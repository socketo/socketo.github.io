<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Digital Forensic Challenge #2 - User Policy Violation Case Write up | socketo.github.io</title>
<meta name="keywords" content="Forensics">
<meta name="description" content="※ 移行前の元ブログ記事 : Digital Forensic Challenge #2 - User Policy Violation Case Write up - #include &lt;sys_socket.h&gt;
本投稿の内容に間違いや問題などありましたら，Twitter経由などでやんわり優しめに教えて頂ければ幸いです．(Twitter:@sys_socket)
恐らく何かしら間違ってたり，足りなかったりします．多分．
誰か教えてください．
はい．
https://www.ashemery.com/dfir.html のChallenge #2
Case1はこちら
Digital Forensic Challenge #1 - Web Server Case Write up - socketo.hatenablog.jp
問題文
This is another digital forensics image that was prepared to cover a full Windows Forensics course.
System Image: here
Hashes: here
Password = here
You can use the image to learn the following:
File Carving, Custom Carving, and Keyword Searching
File System Forensics - NTFS
Deep Windows Registry Forensics: System and User Hives
SYSTEM
SOFTWARE
SAM
NTUSER.DAT
USRCLASS.DAT
Other Windows Files: LNK, Jump Lists, Libraries, etc
Application Compatibility Cache (ShimCache)
Analyzing Windows Search (Search Charm)
Analyzing Thumb Caches
Analyzing Prefetch Files
Analyzing Recycle Bin(s)
USB Forensics
Events Analysis
Email Forensics: Web and Outlook
Browser Forensics: Internet Explorer and Google Chrome
Skype Forensics
This image covers most if not all of the recent system artifacts that you might encounter. Let me know if you need any help or if you are an instructor and want the answers to each part of the case. I will only send the answers to verified instructors.

Due to lots of requests, I have decided to compile a manual or a book for the second image with Q&amp;As to help you go through the challenge and solve every part of it. URLs and further explanations will be provided very soon. Stay tuned my friends and happy hunting ;)
このイメージで以下のことが学べるらしい">
<meta name="author" content="">
<link rel="canonical" href="https://socketo.github.io/posts/2018/02/19/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css" integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF&#43;13Dyqob6ASlTrTye8=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://socketo.github.io/images/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://socketo.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://socketo.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://socketo.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://socketo.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://socketo.github.io/posts/2018/02/19/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://socketo.github.io/posts/2018/02/19/">
  <meta property="og:site_name" content="socketo.github.io">
  <meta property="og:title" content="Digital Forensic Challenge #2 - User Policy Violation Case Write up">
  <meta property="og:description" content="※ 移行前の元ブログ記事 : Digital Forensic Challenge #2 - User Policy Violation Case Write up - #include &lt;sys_socket.h&gt;
本投稿の内容に間違いや問題などありましたら，Twitter経由などでやんわり優しめに教えて頂ければ幸いです．(Twitter:@sys_socket)
恐らく何かしら間違ってたり，足りなかったりします．多分． 誰か教えてください．
はい．
https://www.ashemery.com/dfir.html のChallenge #2
Case1はこちら Digital Forensic Challenge #1 - Web Server Case Write up - socketo.hatenablog.jp
問題文 This is another digital forensics image that was prepared to cover a full Windows Forensics course. System Image: here Hashes: here Password = here You can use the image to learn the following: File Carving, Custom Carving, and Keyword Searching File System Forensics - NTFS Deep Windows Registry Forensics: System and User Hives SYSTEM SOFTWARE SAM NTUSER.DAT USRCLASS.DAT Other Windows Files: LNK, Jump Lists, Libraries, etc Application Compatibility Cache (ShimCache) Analyzing Windows Search (Search Charm) Analyzing Thumb Caches Analyzing Prefetch Files Analyzing Recycle Bin(s) USB Forensics Events Analysis Email Forensics: Web and Outlook Browser Forensics: Internet Explorer and Google Chrome Skype Forensics This image covers most if not all of the recent system artifacts that you might encounter. Let me know if you need any help or if you are an instructor and want the answers to each part of the case. I will only send the answers to verified instructors. Due to lots of requests, I have decided to compile a manual or a book for the second image with Q&amp;As to help you go through the challenge and solve every part of it. URLs and further explanations will be provided very soon. Stay tuned my friends and happy hunting ;) このイメージで以下のことが学べるらしい">
  <meta property="og:locale" content="ja">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2018-02-19T09:06:57+00:00">
    <meta property="article:modified_time" content="2018-02-19T09:06:57+00:00">
    <meta property="article:tag" content="Forensics">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Digital Forensic Challenge #2 - User Policy Violation Case Write up">
<meta name="twitter:description" content="※ 移行前の元ブログ記事 : Digital Forensic Challenge #2 - User Policy Violation Case Write up - #include &lt;sys_socket.h&gt;
本投稿の内容に間違いや問題などありましたら，Twitter経由などでやんわり優しめに教えて頂ければ幸いです．(Twitter:@sys_socket)
恐らく何かしら間違ってたり，足りなかったりします．多分．
誰か教えてください．
はい．
https://www.ashemery.com/dfir.html のChallenge #2
Case1はこちら
Digital Forensic Challenge #1 - Web Server Case Write up - socketo.hatenablog.jp
問題文
This is another digital forensics image that was prepared to cover a full Windows Forensics course.
System Image: here
Hashes: here
Password = here
You can use the image to learn the following:
File Carving, Custom Carving, and Keyword Searching
File System Forensics - NTFS
Deep Windows Registry Forensics: System and User Hives
SYSTEM
SOFTWARE
SAM
NTUSER.DAT
USRCLASS.DAT
Other Windows Files: LNK, Jump Lists, Libraries, etc
Application Compatibility Cache (ShimCache)
Analyzing Windows Search (Search Charm)
Analyzing Thumb Caches
Analyzing Prefetch Files
Analyzing Recycle Bin(s)
USB Forensics
Events Analysis
Email Forensics: Web and Outlook
Browser Forensics: Internet Explorer and Google Chrome
Skype Forensics
This image covers most if not all of the recent system artifacts that you might encounter. Let me know if you need any help or if you are an instructor and want the answers to each part of the case. I will only send the answers to verified instructors.

Due to lots of requests, I have decided to compile a manual or a book for the second image with Q&amp;As to help you go through the challenge and solve every part of it. URLs and further explanations will be provided very soon. Stay tuned my friends and happy hunting ;)
このイメージで以下のことが学べるらしい">
      <meta name="twitter:site" content="@https://twitter.com/sys_socket">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://socketo.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Digital Forensic Challenge #2 - User Policy Violation Case Write up",
      "item": "https://socketo.github.io/posts/2018/02/19/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Digital Forensic Challenge #2 - User Policy Violation Case Write up",
  "name": "Digital Forensic Challenge #2 - User Policy Violation Case Write up",
  "description": "※ 移行前の元ブログ記事 : Digital Forensic Challenge #2 - User Policy Violation Case Write up - #include \u0026lt;sys_socket.h\u0026gt;\n本投稿の内容に間違いや問題などありましたら，Twitter経由などでやんわり優しめに教えて頂ければ幸いです．(Twitter:@sys_socket)\n恐らく何かしら間違ってたり，足りなかったりします．多分． 誰か教えてください．\nはい．\nhttps://www.ashemery.com/dfir.html のChallenge #2\nCase1はこちら Digital Forensic Challenge #1 - Web Server Case Write up - socketo.hatenablog.jp\n問題文 This is another digital forensics image that was prepared to cover a full Windows Forensics course. System Image: here Hashes: here Password = here You can use the image to learn the following: File Carving, Custom Carving, and Keyword Searching File System Forensics - NTFS Deep Windows Registry Forensics: System and User Hives SYSTEM SOFTWARE SAM NTUSER.DAT USRCLASS.DAT Other Windows Files: LNK, Jump Lists, Libraries, etc Application Compatibility Cache (ShimCache) Analyzing Windows Search (Search Charm) Analyzing Thumb Caches Analyzing Prefetch Files Analyzing Recycle Bin(s) USB Forensics Events Analysis Email Forensics: Web and Outlook Browser Forensics: Internet Explorer and Google Chrome Skype Forensics This image covers most if not all of the recent system artifacts that you might encounter. Let me know if you need any help or if you are an instructor and want the answers to each part of the case. I will only send the answers to verified instructors. Due to lots of requests, I have decided to compile a manual or a book for the second image with Q\u0026amp;As to help you go through the challenge and solve every part of it. URLs and further explanations will be provided very soon. Stay tuned my friends and happy hunting ;) このイメージで以下のことが学べるらしい\n",
  "keywords": [
    "Forensics"
  ],
  "articleBody": "※ 移行前の元ブログ記事 : Digital Forensic Challenge #2 - User Policy Violation Case Write up - #include 本投稿の内容に間違いや問題などありましたら，Twitter経由などでやんわり優しめに教えて頂ければ幸いです．(Twitter:@sys_socket)\n恐らく何かしら間違ってたり，足りなかったりします．多分． 誰か教えてください．\nはい．\nhttps://www.ashemery.com/dfir.html のChallenge #2\nCase1はこちら Digital Forensic Challenge #1 - Web Server Case Write up - socketo.hatenablog.jp\n問題文 This is another digital forensics image that was prepared to cover a full Windows Forensics course. System Image: here Hashes: here Password = here You can use the image to learn the following: File Carving, Custom Carving, and Keyword Searching File System Forensics - NTFS Deep Windows Registry Forensics: System and User Hives SYSTEM SOFTWARE SAM NTUSER.DAT USRCLASS.DAT Other Windows Files: LNK, Jump Lists, Libraries, etc Application Compatibility Cache (ShimCache) Analyzing Windows Search (Search Charm) Analyzing Thumb Caches Analyzing Prefetch Files Analyzing Recycle Bin(s) USB Forensics Events Analysis Email Forensics: Web and Outlook Browser Forensics: Internet Explorer and Google Chrome Skype Forensics This image covers most if not all of the recent system artifacts that you might encounter. Let me know if you need any help or if you are an instructor and want the answers to each part of the case. I will only send the answers to verified instructors. Due to lots of requests, I have decided to compile a manual or a book for the second image with Q\u0026As to help you go through the challenge and solve every part of it. URLs and further explanations will be provided very soon. Stay tuned my friends and happy hunting ;) このイメージで以下のことが学べるらしい\nファイルカービング，カスタムカービング，キーワード検索\nファイルシステムフォレンジック - NTFS\nDeep Windows レジストリフォレンジック:システムとユーザのハイブ\nSYSTEM SOFTWARE SAM NTUSER.DAT USRCLASS.DAT その他のWindowsファイル:LNK，ジャンプリスト，ライブラリなど\nShimCache\nWindows検索の分析\nThumbキャッシュの分析\nPrefetchファイルの分析\nゴミ箱の分析\nUSBフォレンジック\nイベント分析\n電子メールフォレンジック:WebとOutlook\nWebブラウザフォレンジック:Internet Exploler, Google Chrome\nSkypeフォレンジック\n***\n調査環境・ツール 有償ツールは使わない流れでいきます．\nFTK(R) Imager 3.2.0 : http://marketing.accessdata.com/ftkimager3.2.0\nSIFT CLI : https://github.com/sans-dfir/sift-cli\nRegRIpper : https://github.com/keydet89/RegRipper2.8 Volatility : https://github.com/volatilityfoundation/volatility foremost : http://foremost.sourceforge.net/ WinPrefetchView : http://www.nirsoft.net/utils/win_prefetch_view.html\nUSNAnalytics : https://www.kazamiya.net/usn_analytics\nHindSight : https://github.com/obsidianforensics/hindsight\nDB Browser for SQLite : http://sqlitebrowser.org/\nXstReader : https://github.com/Dijji/XstReader\nPSTWalker : https://pstwalker.com/\nNetworkUsageView : https://www.nirsoft.net/utils/network_usage_view.html\n調査 基本情報を調べる Case1と同じでregripperを使用して，各基本情報を調べる\nOS情報 OS Windows 8.1 Enterprise timezone 前回と同じくUTC-7なことを確認\n[vagrant@siftworkstation:/vagrant_data/ashemery/Challenge02/reg]$ rip.pl -r SYSTEM -p timezone Launching timezone v.20160318 timezone v.20160318 (System) Get TimeZoneInformation key contents TimeZoneInformation key ControlSet001\\Control\\TimeZoneInformation LastWrite Time Tue Jun 21 09:14:37 2016 (UTC) DaylightName -\u003e @tzres.dll,-211 StandardName -\u003e @tzres.dll,-212 Bias -\u003e 480 (8 hours) ActiveTimeBias -\u003e 420 (7 hours) TimeZoneKeyName-\u003e Pacific Standard Time ComputerName/Hostname [vagrant@siftworkstation:/vagrant_data/ashemery/Challenge02/reg]$ rip.pl -r SYSTEM -p compname Launching compname v.20090727 compname v.20090727 (System) Gets ComputerName and Hostname values from System hive ComputerName = 4ORENSICS TCP/IP Hostname = 4orensics User確認 [vagrant@siftworkstation:/vagrant_data/ashemery/Challenge02/reg]$ rip.pl -r SAM -p samparse Launching samparse v.20160203 samparse v.20160203 (SAM) Parse SAM file for user \u0026 group mbrshp info User Information ------------------------- Username : Administrator [500] Full Name : User Comment : Built-in account for administering the computer/domain Account Type : Default Admin User Account Created : Tue Jun 21 08:19:47 2016 Z Name : Last Login Date : Tue Mar 18 10:20:36 2014 Z Pwd Reset Date : Tue Mar 18 10:20:39 2014 Z Pwd Fail Date : Never Login Count : 3 --\u003e Normal user account --\u003e Password does not expire --\u003e Account Disabled Username : Guest [501] Full Name : User Comment : Built-in account for guest access to the computer/domain Account Type : Default Guest Acct Account Created : Tue Jun 21 08:19:47 2016 Z Name : Last Login Date : Never Pwd Reset Date : Never Pwd Fail Date : Never Login Count : 0 --\u003e Normal user account --\u003e Password does not expire --\u003e Password not required --\u003e Account Disabled Username : Hunter [1001] Full Name : User Comment : Account Type : Default Admin User Account Created : Tue Jun 21 08:37:43 2016 Z Name : Password Hint : What do you do? Last Login Date : Tue Jun 21 01:42:40 2016 Z Pwd Reset Date : Tue Jun 21 08:37:43 2016 Z Pwd Fail Date : Tue Jun 21 12:53:04 2016 Z Login Count : 3 --\u003e Normal user account --\u003e Password does not expire --\u003e Password not required Username : HomeGroupUser$ [1003] Full Name : HomeGroupUser$ User Comment : Built-in account for homegroup access to the computer Account Type : Custom Limited Acct Account Created : Tue Jun 21 08:40:06 2016 Z Name : Last Login Date : Never Pwd Reset Date : Tue Jun 21 08:40:06 2016 Z Pwd Fail Date : Never Login Count : 0 --\u003e Normal user account --\u003e Password does not expire やる “User Policy Violation\"とのことなので，適当に見る．\nプログラム実行履歴 Prefetch アプリケーション起動速度を速める為にWindows XP以降に実装された仕組み．\n詳しい話は以下のブログにて色々と書いてあるので参考に．\n簡易解析入門 プログラム実行の痕跡の調査 (1)Prefetch: セクタンラボ 実験日誌 http://sectanlab.sblo.jp/article/115076023.html\n上のブログと同じように，WinPrefetchViewを使う．\nFTK ImagerでC:\\Windows\\PrefetchフォルダをExportして，メニューからOptions-Advanced Optionsを選択しExportしてきたPrefetchフォルダを読み込ませる．\n※WinPrefetchViewはデフォルトの表示時間がローカルタイムになってしまうので，Options-Show Time in GMTのチェックを入れるようにする．\nUser Policy Violationというケースタイトルなので，内部不正を行う時に使用しそうなっぽいソフトウェアとか普通のユーザが入れないソフトウェアっぽいのをとりあえず列挙する．\nCCleaner Dropbox FTK Imager Outlook Python Skype TorBrowser installer Wireshark Zenmap UserAssist Exploler経由で起動したアプリケーションが　HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssistに保存されている．regedit.exeで見るとROT13しているが，RegistryExplorlerで見るといい感じにROT13を復号してくれている．\nいい感じにregripperでuserassistプラグインを使用し，実行履歴を出す．\n色々と実行してる．\n[socketo@siftworkstation:/vagrant_data/ashemery/Challenge02]$ rip.pl -r reg/NTUSER.DAT -p userassist ～省略～ {CEBFF5CD-ACE2-4F4F-9178-9926F41749EA} Tue Jun 21 12:29:55 2016 Z C:\\Users\\Hunter\\Downloads\\FTK-Imager\\FTK Imager.exe (2) Tue Jun 21 12:28:08 2016 Z {6D809377-6AF0-444B-8957-A3773F02200E}\\CCleaner\\CCleaner64.exe (1) Tue Jun 21 12:26:30 2016 Z {6D809377-6AF0-444B-8957-A3773F02200E}\\Microsoft Office\\Office15\\WINWORD.EXE (2) Tue Jun 21 12:26:17 2016 Z C:\\Python27\\pythonw.exe (1) Tue Jun 21 12:08:13 2016 Z {7C5A40EF-A0FB-4BFC-874A-C0F2E0B9FA8E}\\Nmap\\zenmap.exe (1) Tue Jun 21 12:02:35 2016 Z {7C5A40EF-A0FB-4BFC-874A-C0F2E0B9FA8E}\\Jetico\\BCWipe\\BCWipe.exe (2) Tue Jun 21 12:01:44 2016 Z {6D809377-6AF0-444B-8957-A3773F02200E}\\CCleaner\\ccleaner.exe (1) Tue Jun 21 12:00:43 2016 Z {7C5A40EF-A0FB-4BFC-874A-C0F2E0B9FA8E}\\TeamViewer\\TeamViewer.exe (1) Tue Jun 21 11:55:37 2016 Z C:\\Users\\Hunter\\Downloads\\putty.exe (1) Tue Jun 21 11:54:48 2016 Z C:\\Users\\Hunter\\Downloads\\SysinternalsSuite\\Procmon.exe (1) Tue Jun 21 11:54:45 2016 Z {F38BF404-1D43-42F2-9305-67DE0B28FC23}\\hh.exe (1) Tue Jun 21 11:54:36 2016 Z C:\\Users\\Hunter\\Downloads\\SysinternalsSuite\\procexp.exe (1) Tue Jun 21 11:52:06 2016 Z {1AC14E77-02E7-4E5D-B744-2EB1AE5198B7}\\notepad.exe (3) Tue Jun 21 11:51:23 2016 Z windows.immersivecontrolpanel_cw5n1h2txyewy!microsoft.windows.immersivecontrolpanel (1) Tue Jun 21 11:44:32 2016 Z C:\\Users\\Hunter\\Downloads\\bcwipeSetup.exe (1) Tue Jun 21 11:44:16 2016 Z C:\\Users\\Hunter\\Downloads\\ccsetup519pro.exe (2) Tue Jun 21 11:38:46 2016 Z {6D809377-6AF0-444B-8957-A3773F02200E}\\Java\\jre1.8.0_91\\bin\\javaw.exe (1) Tue Jun 21 11:19:14 2016 Z C:\\Users\\Hunter\\Downloads\\python-3.5.1.exe (1) Tue Jun 21 11:17:58 2016 Z {1AC14E77-02E7-4E5D-B744-2EB1AE5198B7}\\msiexec.exe (1) Tue Jun 21 11:06:44 2016 Z C:\\Users\\Hunter\\Downloads\\Hash_Suite_Free\\Hash_Suite_64.exe (1) Tue Jun 21 09:28:21 2016 Z D:\\VBoxWindowsAdditions.exe (1) Tue Jun 21 09:27:00 2016 Z {7C5A40EF-A0FB-4BFC-874A-C0F2E0B9FA8E}\\Google\\Chrome\\Application\\chrome.exe (2) Tue Jun 21 08:41:33 2016 Z C:\\Users\\Hunter\\Downloads\\ChromeSetup.exe (1) Tue Jun 21 08:38:47 2016 Z Microsoft.InternetExplorer.Default (1) Tue Jun 21 02:00:01 2016 Z {7C5A40EF-A0FB-4BFC-874A-C0F2E0B9FA8E}\\Adobe\\Acrobat Reader DC\\Reader\\AcroRd32.exe (5) Tue Jun 21 01:51:06 2016 Z Dropbox.Desktop.Client (1) Tue Jun 21 01:43:24 2016 Z Chrome (3) Mon Jun 20 23:53:36 2016 Z {1AC14E77-02E7-4E5D-B744-2EB1AE5198B7}\\cmd.exe (1) USNジャーナルの解析 Case1と同じく，USNAnalyticsを使用．\n各アーティファクトで出てきた結果とかの裏付けとかで適宜確認する．\nLNKファイル解析 LNKファイルはWindowsのショートカットファイルの拡張子で，ユーザがファイル，ドキュメントを開いた際にLNKファイルが生成されるので触ったファイルが分かる．\nC:\\Users\\{username}\\AppData\\Roaming\\Microsoft\\Windows\\Recentに.lnkファイルが生成される．\n中を見てみると，左側にバツマークがついており削除されていることが分かる ． ユーザが意図的に消したか，CCleanerのような最適化ツールによって削除したかなど考えられる．\nSkype Skypeについて見ていく．\nSkypeのアーティファクトについては以下を参考．\nSkype Forensics: Analyzing Call and Chat Data From Computers and Mobile(pdf) : https://www.magnetforensics.com/wp-content/uploads/2014/04/Skype-Forensics-Analyzing-Call-and-Chat-Data-From-Computers-and-Mobile-Magnet-Forensics.pdf\nUsers/Hunter/AppData/Roaming/Skype/hunterhpt/ディレクトリをFTK ImagerでExportする．\nUsers/Hunter/AppData/Roaming/Skype/hunterhpt/main.dbに実際のSkypeの色々が格納されている． まずアカウント情報を見ていく．\nアカウント情報はAccountsテーブルに格納されている．\nこのSkypeを利用していたMicrosoftアカウントのメールアドレスがehptmsgs@gmail.comということがわかる．\n次にチャットメッセージを見る．\nチャットメッセージはMessagesテーブルに格納されている． 一応，見れるが文字コードとかがおかしいのか中身を読めない．\nSkypeのログを見る便利なツールがあるので，これに頼る．\nSkype Log Viewer : http://www.nirsoft.net/utils/skype_log_view.html\nExportしたUsers/Hunter/AppData/Roaming/Skype/hunterhpt/を読み込ませるといい感じに表示してくれる．\n見やすいように時系列順に会話を並べて形成する．\n(多分ローカルのTimezoneに合わせられているので-9にしてUTCに直す)\n会話ログ原文\ndatetime Display Name Chat Message 2016/06/21 00:36:56 EHPT Msgs hello 2016/06/21 00:37:02 Linux rul3z hello 2016/06/21 00:37:37 EHPT Msgs I have some pics that need to send outside my network 2016/06/21 00:37:54 EHPT Msgs but the problem is that our network is monitored 2016/06/21 00:38:32 EHPT Msgs I need to bypass their censorships 2016/06/21 00:38:53 EHPT Msgs also I need to get access to documents and send them 2016/06/21 00:39:04 EHPT Msgs so I am asking for your help 2016/06/21 00:39:10 Linux rul3z hmm 2016/06/21 00:39:16 Linux rul3z what kind of pics? 2016/06/21 00:39:30 Linux rul3z and what is the type of docs u need to send outside? 2016/06/21 00:39:42 EHPT Msgs the pics are something special 2016/06/21 00:40:03 EHPT Msgs some of the docs are for products 2016/06/21 00:40:16 EHPT Msgs others are for other misc stuff 2016/06/21 00:40:30 Linux rul3z no worries 2016/06/21 00:40:55 Linux rul3z let us work on them separately 2016/06/21 00:41:03 EHPT Msgs what do you mean? 2016/06/21 00:41:15 Linux rul3z I mean, let us first find away to access your device 2016/06/21 00:41:31 Linux rul3z and then, see what can we do in order to exfil the docs/pics outside ur network 2016/06/21 00:41:33 EHPT Msgs ok 2016/06/21 00:41:37 EHPT Msgs that sounds great 2016/06/21 00:41:43 EHPT Msgs but is this truly doable? 2016/06/21 00:41:47 Linux rul3z there is no limits 2016/06/21 00:41:51 Linux rul3z sure it is ;) 2016/06/21 00:41:59 EHPT Msgs when shall we start 2016/06/21 00:42:00 EHPT Msgs ? 2016/06/21 00:42:12 Linux rul3z Can I access your machine? 2016/06/21 00:42:26 EHPT Msgs hmm, not sure since our network is monitored as I told u 2016/06/21 00:42:33 Linux rul3z okay wait 2016/06/21 00:47:17 Linux rul3z can you install team viewer? 2016/06/21 00:47:36 EHPT Msgs I am not sure 2016/06/21 00:47:39 EHPT Msgs but let me see 2016/06/21 00:47:47 EHPT Msgs I will inform you once I am finished 2016/06/21 00:47:51 EHPT Msgs how can I reach u? 2016/06/21 00:48:12 Linux rul3z send an email to my Hotmail account 2016/06/21 00:48:17 EHPT Msgs which one? 2016/06/21 00:48:25 Linux rul3z same as Skype ;) 2016/06/21 00:48:32 EHPT Msgs ok :D 2016/06/21 00:48:34 EHPT Msgs understood 2016/06/21 00:48:46 EHPT Msgs see you soon 2016/06/21 00:48:52 Linux rul3z yeah 2016/06/21 00:48:54 EHPT Msgs bye bye 2016/06/21 00:48:56 Linux rul3z bye 2016/06/21 11:48:37 EHPT Msgs To view this shared file, go to: fakeporn.7z fakeporn.7z https://login.skype.com/login/sso?go=webclient.xmm\u0026amp;docid=0-weu-d2-a958c1f0bec3eaa30bcef8d795c8ff63 2016/06/21 11:48:46 EHPT Msgs Nice pics;) 会話ログ意訳(日時UTC)\ndatetime Display Name Chat Message 2016/06/21 00:36:56 EHPT Msgs ハロー 2016/06/21 00:37:02 Linux rul3z ハロー 2016/06/21 00:37:37 EHPT Msgs 私はネットワークの外に送信する必要がある幾つかの写真を持ってる 2016/06/21 00:37:54 EHPT Msgs でも問題としてネットワークが監視されている 2016/06/21 00:38:32 EHPT Msgs 私はその検閲を回避する必要がある 2016/06/21 00:38:53 EHPT Msgs さらに私はドキュメントにアクセスしてそれらを送信する必要がある 2016/06/21 00:39:04 EHPT Msgs だから私はあなたに助けを求めている 2016/06/21 00:39:10 Linux rul3z ウーン… 2016/06/21 00:39:16 Linux rul3z どんな写真？ 2016/06/21 00:39:30 Linux rul3z ネットワークの外に送信する必要があるドキュメントのタイプは何？ 2016/06/21 00:39:42 EHPT Msgs 写真はスペシャルなもの 2016/06/21 00:40:03 EHPT Msgs いくつかのドキュメントはプロダクト用 2016/06/21 00:40:16 EHPT Msgs その他は他の資料 2016/06/21 00:40:30 Linux rul3z 心配ない 2016/06/21 00:40:55 Linux rul3z それらは個々に作業をしよう 2016/06/21 00:41:03 EHPT Msgs どういう意味？ 2016/06/21 00:41:15 Linux rul3z とういうのは，まず私達にあなたのデバイスにアクセスさせてください 2016/06/21 00:41:31 Linux rul3z そして，あなたのネットワークの外にドキュメント/写真がexfil(対象を外的環境から奪取す?)るのを見てください 2016/06/21 00:41:33 EHPT Msgs ok 2016/06/21 00:41:37 EHPT Msgs それは良いです 2016/06/21 00:41:43 EHPT Msgs これは本当に実践できるだろうか？ 2016/06/21 00:41:47 Linux rul3z ここに制限は無い 2016/06/21 00:41:51 Linux rul3z もちろん;) 2016/06/21 00:41:59 EHPT Msgs いつはじめますか 2016/06/21 00:42:00 EHPT Msgs ? 2016/06/21 00:42:12 Linux rul3z 私はあなたのマシンにアクセスできますか？ 2016/06/21 00:42:26 EHPT Msgs うーん，言ったようにネットワークは監視されているので 2016/06/21 00:42:33 Linux rul3z オーケー，待って 2016/06/21 00:47:17 Linux rul3z TeamViewerはインストールできる？ 2016/06/21 00:47:36 EHPT Msgs よくわかりませんが 2016/06/21 00:47:39 EHPT Msgs そうですね 2016/06/21 00:47:47 EHPT Msgs 終わったら知らせます 2016/06/21 0047:51 EHPT Msgs どのようにしてあなたにとどけることができますか？ 2016/06/21 00:48:12 Linux rul3z 私のHotmailアカウントにメールを送ってください 2016/06/21 00:48:17 EHPT Msgs どれ？ 2016/06/21 00:48:25 Linux rul3z Skypeと同じ;) 2016/06/21 00:48:32 EHPT Msgs ok :D 2016/06/21 00:48:34 EHPT Msgs 理解した 2016/06/21 00:48:46 EHPT Msgs また近いうちに 2016/06/21 00:48:52 Linux rul3z yeah 2016/06/21 00:48:54 EHPT Msgs bye bye 2016/06/21 00:48:56 Linux rul3z bye 2016/06/21 11:48:37 EHPT Msgs To view this shared file, go to: fakeporn.7z fakeporn.7z https://login.skype.com/login/sso?go=webclient.xmm\u0026amp;docid=0-weu-d2-a958c1f0bec3eaa30bcef8d795c8ff63 2016/06/21 11:48:46 EHPT Msgs Nice pics;) 会話の流れからして，EHPT Msgsがこの端末の所持者で社内ネットワークから機密事項である写真とドキュメントを外に送ろうとしているが，ネットワークが監視されているのでどうしようとLinux rul3zに相談をしている感じです．\nネットワークが監視されているということで，TeamViewerをインストールさせてそれ経由でリモート操作をしようとしている感じですね．\nTeamViewerは操作される端末側のIDとパスワードを入力することで操作側から端末にリモートでアクセスすることができます．\nおそらく，このLinux rul3zのHotmailにそのIDとかパスワードが送信されるのでしょう．たぶん．\nLinux rul3zはHotmailのIDはSkypeと一緒だと言っているのでメールアドレスはlinux-rul3z@hotmail.comでしょう．\nSkypeから分かったことと推測 EHPT MsgsがLinux rul3zに内部ネットワークから外部にドキュメントと写真を送信したいと相談 EHPT Msgsのネットワークは監視されている Linux rul3zがEHPT Msgsの端末にアクセスをしてどうにか取得をしようとしている EHPT Msgsの端末にTeamViewerをインストールしてLinux rul3zがリモートアクセスをしようとしている TeamViewerのセットアップが終了したら，Linux rul3zのメールアドレスlinux-rul3z@hotmail.comにTeamViewerの認証情報とかを送信しようとしている メール SkypeでHotmailに送ってくれと言われていたので，メールの証跡を調べる．\nPrefetchファイルやUserAssistからOutlookが実行されていたことが分かるので，Outlookのメールを調べる．\nOutlookのデータファイルは.pstか.ostの形式で保存されている．\nOutlook データ ファイル (.pst および .ost) の概要 - Outlook https://support.office.com/ja-jp/article/outlook-%E3%83%87%E3%83%BC%E3%82%BF-%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB-pst-%E3%81%8A%E3%82%88%E3%81%B3-ost-%E3%81%AE%E6%A6%82%E8%A6%81-222eaf92-a995-45d9-bde2-f331f60e2790\n.pst，.ostファイルは以下のパスに保存されているので見る．\nC:/Users/user/AppData/Local/Microsoft/Outlook/\nehptmsgs@gmail.com.ostというファイルを確認しファイルをExportする．\n次にExportした.ostファイルを閲覧する．\nあいにく手元に使えるOutlookのライセンスが無いので，何かしらの.ostファイルViewerが必要になる．\nはじめにFreeOSTViewerを試したが，読み込むことが出来ずに断念．\n次にXstReaderを使用．\nhttps://github.com/Dijji/XstReader\nExportした.ostファイルを読み込む\n色々とメールが残っていることを確認．だが，日付あっても時間が表示されていないのでまたまた違うツールを検討．\n続いてはPST Walkerの評価版を使用． https://pstwalker.com/\nExportしてきた.ostファイルを開くと見れる．今回は受信した日時，送信した日時も表示されているので大丈夫そう．\n評価版なので少し制限があるらしく，一定時間にメールの中身を閲覧する制限があるのでその部分はXstReaderで補っていく．\n恐らく時間がローカルのタイムゾーンに合わせられてしまうので，UTCに直すために-9した時間を表示．\nメールのタイムライン メールの中身を見てく． InboxとSent Mailである程度時系列にまとめる．\n日時(UTC) 送信者 受信者 件名 メール内容(要約) 添付ファイル 2016/06/21 00:53:13 ehptmsgs@gmail.com linux-rul3z@hotmail.com TeamViewer TeamViewインストールしたけどいつから話せますか？ 無し 2016/06/21 00:53:13 linux-rul3z@hotmail.com ehptmsgs@gmail.com RE:TeamViewer 今仕事中なので終わったらできます．Skypeでpingします 無し 2016/06/21 00:57:50 ehptmsgs@gmail.com linux-rul3z@hotmail.com RE:TeamViewer 了解です 無し 2016/06/21 01:00:31 ehptmsgs@gmail.com linux-rul3z@hotmail.com Pics このメールに添付した.7zファイルに写真が入ってる．Skype経由でパスワードを渡します “Pictures.7z” 2016/06/21 01:01:28 linux-rul3z@hotmail.com ehptmsgs@gmail.com RE:Pics 了解です 無し 2016/06/21 11:04:05 linux-rul3z@hotmail.com ehptmsgs@gmail.com DNS Exifl Videos DNS Data Exfiltrationに関する動画(YouTubeのリンク)の共有 無し 2016/06/21 01:54:21 no-reply@accounts.google.com ehptmsgs@gmail.com New sign-in from Windows Googleアカウント新規アクセス 無し 2016/06/21 01:57:16 linux-rul3z@hotmail.com ehptmsgs@gmail.com File Extensions ファイルを隠すために拡張子を変えることのアドバイス．PDFファイルの拡張子を確認してください 無し 2016/06/21 01:57:53 ehptmsgs@gmail.com linux-rul3z@hotmail.com RE:File Extensions やってみます．少し待ってください 無し 2016/06/21 01:01:17 ehptmsgs@gmail.com linux-rul3z@hotmail.com RE:File Extensions これを確認してください添付ファイル “Config.png” 2016/06/21 11:32:14 ehptmsgs@gmail.com linux4rulez@gmail.com Hangouts? あなたからのメール確認しました．Hangoutは繋がりますか？ 無し 2016/06/21 11:50:24 ehptmsgs@gmail.com linux-rul3z@hotmail.com, linux4rulez@gmail.com Nice Pics 素敵な写真を添付します．気に入ったら教えてください “fakeporn.7z” 2016/06/21 11:51:04 ehptmsgs@gmail.com linux-rul3z@hotmail.com RE:DNS Exifl Videos 動画を保存して見てみますが 無し 2016/06/21 11:56:39 linux-rul3z@hotmail.com ehptmsgs@gmail.com RE:DNS Exifl Videos それをしないでください．ネットワーク検知されてしまいます 無し 2016/06/21 11:57:47 ehptmsgs@gmail.com linux-rul3z@hotmail.com RE:DNS Exifl Videos わかりました削除します．それらのフォルダと情報を全て削除します 無し 2016/06/21 12:19:33 ehptmsgs@gmail.com linux-rul3z@hotmail.com, linux4rulez@gmail.com Network Design ネットワーク設計のサンプルの添付 “home-network-design-networking-for-a-single-family-home-case-house-arkko-1433-x-792.jpg” 2016/06/21 12:20:39 linux4rulez@gmail.com ehptmsgs@gmail.com RE:Network Design ネットワーク用のオリジナルプリントを入手してください 無し 2016/06/21 12:31:20 linux4rulez@gmail.com ehptmsgs@gmail.com Fwd:Network Design “RE:Network Design\"の転送メール 無し 2016/06/21 13:16:00 ehptmsgs@gmail.com linux-rul3z@hotmail.com Greetings Outlookの設定の確認のテストとプロジェクトの終了 無し メール経由で送信されたファイルは以下の4つのファイル\nPictures.7z Config.jpg fakeporn.7z home-network-design-networking-for-a-single-family-home-case-house-arkko-1433-x-792.jpg 2016/06/21 01:57:16に受信したメールで言及されているように，添付ファイルの拡張子を偽装したものが\"Config.jpg\"だと考えられる．\n実際にファイルヘッダを見てみるとどう見てもPDFっぽい感じで.jpgでない． 拡張子を.jpgから.pdfに変更して閲覧する．\nとりあえず\"Confidential Docment\"と書かれているので恐らく持ち出してはいけない感じのファイルっぽい．\n残りのPictures.7zとfakeporn.7zに関してはパスワードがかけられていて今のところ中身は確認することが出来ない．\nPictures.7zに関してはSkype経由でパスワードを送っていることが2016/06/21 01:00:31に受信したメールから分かる．\nfakeporn.7zのパスワードに関しては述べられていないが，このファイルが添付されているメールの一つ前にHangoutが出来るかというメールを送っている(2016/06/21 11:32:14)のでHangout経由で送ったのか，それともSkype経由で送ったものかを推測することが出来る．\nSkypeのログからパスワードを探したい．\nだが，現存するスカイプのログでは2016/06/21/ 00:48:56～2016/06/21 11:48:56が無く，レコード番号も2016/06/21/ 09:48:56の738と2016/06/21 11:48:56の741の間が存在していないことから，パスワード送信部分のメッセージ(739, 740)が削除された可能性がある．\nメールから分かったことと推測 この端末を使用しているユーザのメールアドレスはehptmsgs@gmail.com\n内部ネットワークから持ち出す際に助言を求めているアカウントLinux rul3zのメールアドレスはlinux-rul3z@hotmail.comとlinux4rulez@gmail.com\n複数個メールでファイル送信が行われている\nPictures.7z : Skypeでパスワードを送信(メール内容より) Config.jpg : ファイル拡張子を”.jpg\"に偽装したPDFファイル fakeporn.7z : パスワード不明 home-network-design-networking-for-a-single-family-home-case-house-arkko-1433-x-792.jpg : ネットワーク構成図(センシティブなものではなさそう(メール内容より)) DNS Data Exfiltrationの手法をするとネットワークに検知される\nGoogle HangoutsをSkypeとメール以外の連絡手段として使用している可能性あり\nWEB履歴 今までのSkype，メールでTeamViewerのインストールやHungoutやYouTubeの動画など確実にWEBブラウザを使用シーンが無数にあったのでWEB履歴を確認する．\nPrefetchから，実行されていたブラウザはChrome, Firefox, InternetExplorerの3つだということが分かった．\nChrome Chromeの履歴に対しては以下のツールを使ってみる．\nobsidianforensics/hindsight\nhttps://github.com/obsidianforensics/hindsight\nPython2.7が必要．\nユーザガイドが丁寧なのでこれに従ってやっていく．\nhttps://github.com/obsidianforensics/hindsight/blob/master/documentation/Hindsight%20User%20Guide%20v1.3.0.pdf\nスクリプトを実行してブラウザで’localhost:8080’へアクセスすると使うことが出来る．\n対象の端末OSがWindows8.1なので \\userdir\\]\\AppData\\Local\\Google\\Chrome\\User Data\\DefaultをFTK ImagerでExportしてProfile Pathに入力すると以下のように結果が出るので，Save XLSXまたはSave [SQLite DBをクリックして.xlsx形式または.sqlite形式で保存する．\n今回はSQLiteDB形式で保存し，DB Browser for SQLiteで中身を見る\nHangouts メールでHangoutsで連絡できるか？と聞いているので，Chromeの履歴からHangoutsの証跡を探さなけれなならない．\nGoogle Hangoutsのフォレンジック関係は，Android端末に対しての言及はあるがPCのChromeからはあまり見当たらないし，まぁ無理な気がする．\nRedditでも言及はあるが，しんどそう．\nGoogle hangouts forensics : computerforensics https://www.reddit.com/r/computerforensics/comments/2631jb/google_hangouts_forensics/\nAndroidのHangoutsについてはまぁありそう．\nGoogle Hangouts analysis - Learning Android Forensics https://www.packtpub.com/mapt/book/networking_and_servers/9781782174578/7/ch07lvl1sec60/google-hangouts-analysis\nなので，WEB履歴から\"hangouts.google.com\"でフィルタをして恐らくHangoutsを使用していた時間帯というのを絞りたい．\nおおまかに以下の時間帯に\"hangouts.google.com\"にアクセスしていた\n2016/06/20 23:59:51～2016/06/21 00:00:05 2016/06/21 01:43:32～2016/06/21 01:43:40 2016/06/21 09:14:44～2016/06/21 09:15:16 2016/06/21 10:45:58～2016/06/21 10:46:49 2016/06/21 11:30:35～2016/06/21 11:32:47 ※ 2016/06/21 12:22:46～2016/06/21 12:22:48 ※ 2016-06-21 12:52:35 ※ 2016/06/21 13:19:25 ※ メール件名\"Hangouts?“を送信した時間以降のものに”※“を表示している．\nHangoutsで相手と連絡をとったのはここのどこかになると推測できる．\n正直それ以外は現状よく分からないのでHangoutsはとりあえずここまで．\nChrome経由でダウンロードされたファイル timelineテーブルにアクセスのタイプ，日時，URL，タイトル…などのカラムに格納されている．\nこのタイプの部分に\"download\"として格納されているものは，Chromeを介してファイルをダウンロードしたものが残っている．\nダウンロードされたファイルは以下のようなものがあった(抜粋)\n2016-06-20 16:57:34.500 : putty.exe 2016-06-20 16:58:03.044 : DEFCON-22-Zoltan-Balazs-Bypass-firewalls-application-whitelists-in-20-seconds-UPDATED.pdf 2016-06-20 17:52:02.028 : TeamViewer_Setup-vfa.exe 2016-06-20 18:43:57.878 : googledrivesync.exe 2016-06-20 18:44:08.835 : DropboxInstaller.exe 2016-06-21 01:54:19.418 : SkypeSetup.exe 2016-06-21 02:15:24.167 : Wireshark-win64-2.0.4.exe 2016-06-21 02:16:35.660 : 7z1602-x64.exe 2016-06-21 03:45:34.221 : ccsetup519pro.exe 2016-06-21 03:48:23.003 : torbrowser-install-6.0.1_en-US.exe 2016-06-21 03:56:27.140 : bcwipeSetup.exe 2016-06-21 03:57:17.593 : Eraser6.2.0.2971-NoRuntimes.exe 2016-06-21 03:58:38.541 : nmap-7.12-setup.exe 2016-06-21 04:00:20.183 : Hash_Suite_Free_3_4.zip 2016-06-21 04:00:58.367 : burpsuite_free_v1.7.03.jar 2016-06-21 04:01:24.055 : SysinternalsSuite.zip 2016-06-21 04:03:41.022 : python-2.7.11.msi 2016-06-21 04:03:42.545 : python-3.5.1.exe 2016-06-21 04:05:00.071 : odbg110.zip ※時間はUTC-7なので+7にしてUTCに変換する必要がある\nInternetExploler IEのWEB履歴を見る．\nIE version10以降の閲覧履歴は以下のファイルに保存されているのでこれをFTK ImagerでExportする．\nC:¥Users¥{Username}¥AppData¥Local¥Microsoft¥Windows¥WebCache. ¥WebCacheV01.dat\n解析にはブラウザの閲覧履歴を解析するツールBrowsing History Viewを使う．\nBrowsingHistoryView - View browsing history of your Web browsers\nhttps://www.nirsoft.net/utils/browsing_history_view.html\nExportしたWebCacheV01.datをメニューからOptions-Advanced Optionsを選択し，Load history from..でLoad history from the specified history filesからInternet Explorer(Version 10.0/11.0) history files(WebCacheV01.dat)にパスを設定する．\nアクセスを見ると，2016/06/21 21:14:39にhttp://www.teamviewer.com/company/shutdown.aspx?version=11.0.59518があるが，これはTeamViewerを終了した際に表示されるWEBページのようで，おそらくこの時間帯にTeamViewerを終了したのではないかと推測出来る．\nWebCacheV01.datがIEでアクセスしたものだけでなく，WindowsのExplolerでアクセスしたファイルについても記録がされている．\n今回のログで残っているものは以下の4つ．\nここもローカルのタイムゾーンに合わせられてしまうので，UTCに直すために-9をする必要があるので直した時間を表示．\nfile:///C:/Users/Hunter/Pictures/Exfil/dns-exfiltration-using-sqlmap-18-728.jpg 2016/06/21 12:17:39 file:///C:/Users/Hunter/Pictures/Exfil/Exfiltration_Diagram.png 2016/06/21 12:17:42 file:///C:/Users/Hunter/Documents/home-network-design-networking-for-a-single-family-home-case-house-arkko-1433-x-792.jpg 2016/06/21 12:19:31 file:///C:/Users/Hunter/Documents/Welcome.docx 2016/06/21 12:27:37 Pictures/Exfil下の画像ファイル2つはメールで言及していたDNS Data Exfiltrationについての画像なのでとりあえず機密な画像では無さそう．\nhome-network-design-networking-for-a-single-family-home-case-house-arkko-1433-x-792.jpgはC:\\Users\\Hunter\\Documents\\に現存していないが，2016/06/21 12:19:33に送信したメールの添付ファイルが同じ名前で恐らくこのファイルでないかと推測が出来る．\n裏付けとして，USNJurnlで調べる．\n冒頭でUSNAnalyticsで出力したusn_analytics_records-20160621T081446.csvでファイルの名前でフィルタをする．\n2016/06/21 12:22:20にHunter\\Documents\\からHunter\\Dropbox\\へ移動していることが分かる．\nとりあえずメールに添付されていたファイルと，Dropboxへ移動したファイルが一致していることを確認する．\nMD5ハッシュ値が一致していることを確認．メールで送信されたネットワーク図がDropboxにアップロードされていた画像と同じことを確認した．\nWelcome.docxはC:\\Users\\Hunter\\Documents\\に現存している普通のドキュメントファイルで開くことが出来た．\n重要な情報を書くために使用する文書だと記述があるので，まぁ重要そうなドキュメントっぽい．\nTorBrowser Chromeのダウンロードや，Prefetch，UserAssistを見ているとTor Browserを実行していることが分かる．\n分かりやすくC:\\Users\\Hunter\\Desktop\\Tor Browserというディレクトリがあるので見ていく．\nTor BrowserはFirefoxをベースにされていて，今回はC:\\Users\\Hunter\\Desktop\\Tor Browser下にあるFirefox.exeを使っているらしい． なので，Prefetch的にはFIREFOX.EXE-FB5E902D.pfとして残っている．\nPrefetchのデータ部分を見ると，参照しているのがデスクトップのTor Browser下のファイルということでこれがTor Browserだということが分かる．\nTor BrowserのフォレンジックについてはSANSが資料を出していたので少し見た．\nTor Forensics on Windows OS(PDF)\nhttps://digital-forensics.sans.org/summit-archives/dfirprague14/Tor_Forensics_On_Windows_OS_Mattia_Epifani.pdf\npagefile.sysにTor Browserを実行，または介してアクセスした際に残る特徴的なキーワードが以下の7つらしい．\nHTTP-memory-only-PB Torproject Tor Torrc Geoip Torbutton Tor-launcher 中でもメモリ上にはHTTP-memory-only-PBの文字列の後にはTor Browserを介してアクセスしたURLが記載されるらしい． pagefile.sysの中を上のキーワードで検索をしたがそれっぽいのは無し．断念．\n気休め程度にTor経由で送受信されたデータ量を確認する．\nSRUMを確認する．\nSRUMはWindows8から導入された，System Resource Usage Monitorの略称のシステム．\nWindows上で動いていたサービスやアプリケーション，ネットワーク接続の活動のデータを保持している．\n詳しい説明は以下のSRUM forensics．\nSRUM forensics\nhttps://www.sans.org/summit-archives/file/summit-archive-1492184583.pdf\nC:\\Windows\\System32\\sru\\SRUDB.datをFTKImagerでExportする．\nネットワーク接続を確認するのにはNetworkUsageViewを使用する．\nNetworkUsageView https://www.nirsoft.net/utils/network_usage_view.html\nこれにExportしたSRUDB.datを読み込ませる．\nアプリケーションやシステムごとにネットワーク接続の送信/受信のデータ量を見ることができる．\ntor.exeがは672,648bytes送信，5,613,506bytes受信となっている．\nそんなに大きな通信は行われなかったということは分かる．\nTeamViewer Skype，メール，WEB履歴，PrefetchからTeamViewerが使用されていたことが分かっているので，TeamViewerについて見ていく．\nTeamViewerのフォレンジックについてのドキュメントがあったりするので見る．\nTeamViewer Forensics - Champlain College(PDF)\nhttps://www.champlain.edu/Documents/LCDI/archive/Team-Viewer-Forensics.pdf\nサポート詐欺や不正なログインの際に使用される事例が増えているということで以下のような記事もあったので参考．\nTeamViewerに気をつけましょう | セキュリティ対策のラック\nhttps://www.lac.co.jp/lacwatch/people/20160606_000357.html\nTeamViewerのログ関係のファイルはC:\\Program Files (x86)\\TeamViewerとC:\\Users\\{Username}\\AppData\\Roaming\\TeamViewerにある．\n今回見るべきログは次の2つくらいっぽい\nC:\\Program Files (x86)\\TeamViewer\\Connections_incoming.txt C:\\Program Files (x86)\\TeamViewer\\TeamViewer11_Logfile.log Connections_incoming.txtはリモートログインされたセッションを記録しています．\nログはUTCで記録されている．以下のログでは2016/06/21 12:05:30～2016/06/21 12:14:29に一度接続されていることが確認出来る．\n547298337 PSUT1 21-06-2016 12:05:30 21-06-2016 12:14:29 Hunter RemoteControl {DFB7FCA2-0F07-4468-BE01-67D73CD83B3A} TeamViewer11_Logfile.logはシステム的なログが残っているが，いい感じのものは残っていなかった．\n上のTeam-Viewer-Forensics.pdfを読むと分かるが，リモートされる端末(被害端末)ではファイル転送のログは残らず，リモートする端末の方のログで一時的に残ることから，今回の被害端末上でファイルが転送されたという証跡は確認することが出来ない．\nTeamViewerから分かったこと 2016/06/21 12:05:30～2016/06/21 12:14:29の間，リモートで操作されていた TeamViewerでの遠隔操作時の動き 上記で分かったTeamViewerの接続時間で何をやっていたのかを調べる必要があるのでとりあえずやる．\nPrefetchから Prefetchを見ると，その時間にzenmap，nmapが実行されていることが分かる．\nzenmapはポートスキャンツールであるnmapのGUI版．\nどこかしらにポートスキャンをしたと考えられる．\nUSNJrnlからこの時間内に作成されたC:\\Users\\Hunter\\.zenmap\\recent_scans.txtを見てみると，以下のファイルパスが書かれている．\nC:\\Users\\Hunter\\Desktop\\nmapscan.xml\nNMAPに関係ありそうなファイルなので見てみる．\nnmapのスキャンログの様子．\nscanme.nmap.org(45.33.32.156)へポートスキャンをしているログを確認することができた．\nCloudストレージ 今回のこの端末にはDropboxとGoogleDriveが入っていた．\n両方共，インストールした後にそのディレクトリにファイルを置いてファイルの設定を変更すると他者と共有することが出来る．\n普通に機密情報とかだとクラウドストレージにアップするだけでも怒られが発生しそうなので，その辺を見る．\nCloud Storage Forensics(PDF)\nhttps://digital-forensics.sans.org/summit-archives/Prague_Summit/Cloud_Storage_Forensics_Mattia_Eppifani.pdf\n有償ツールを使ったりメモリを使ったりしていたので，今回はUSNJrnl上でC:\\Users\\Hunter\\DropboxディレクトリとC:\\Users\\Hunter\\Google Driveを見てファイルの流れを確認する．\n各アップロードされたファイル\nDropbox Get Started with Dropbox.pdf : Dropboxの始め方の説明 Accounts.txt : 使用しているアカウント一覧(Gmail, Skype, TeamViewer, GoogleDrive, Dropbox) Info/TechnialInfo.txt : 2016/06/21 11:04:05に受信したメールのDNS Data ExfiltrationのYouTube動画リンク集 home-network-design-networking-for-a-single-family-home-case-house-arkko-1433-x-792.jpg Outlook/backup.pst : メールのバックアップファイル Pictures.7z : メールで送信したアーカイブファイル Google Drive\nPyhton and the Army Knife (Recoverd).gslides : Googleスライド(URLが中に入っているが限定公開の模様) Getting Started : Google Driveの公式の開始pdf tools.txt : 2016/06/21 11:04:05に受信したメールのDNS Data ExfiltrationのYouTube動画リンク集 Accounts.txt : このアカウントに居ストールするアプリケーションたち(Chrome, Skype, Outlook,など) proposal.pdf : 4orensics – Training and Consultation Servicesについて(宣伝) FTK-Imager.zip Pictures.7zとfakeporn.7zの中身を探す Pictures.7z USNJrnlでPictures.7zをフィルタすると，初回登場が.lnkファイルとなる．\nちなみにこのLNKファイルは削除されているため，どこを参照したものなのかが不明．\nCREATEされたパスがDropboxになっていることから，このファイルはDropbox経由で取得したものの可能性もあると考えることが出来る．\nfakeporn.7z USNJrnlで\"fakeporn\"で検索をする．\n2016/06/21 11:45:03にC:\\Users\\Hunter\\Pictures`下にfakepornというディレクトリが作られ，そのディレクトリへ.画像ファイルが保存されていることが分かる．\nChromeのWEB履歴内で保存パスをC:\\Users\\hunter\\Pictures\\fakepornで検索をするとファイルが複数ヒットする．\nそのURLを見ていくと，可愛らしい動物の写真が出て来る．\n恐らく，fakeporn.7zの中身はそれらの画像だということを推測．\nそして後にfakeporn.7zは2016/06/21 12:01:07にmofygdvh.mcpへリネームしたことをUSNJrnlで確認した．\nFileCarving 最初の要件的にファイルカービングを行う必要があるっぽいのでやる．\nカービングはファイルのヘッダ/フッタを探しだして2つの間のブロックを切り取ってファイル復元をするものらしい．\n断片とかをつなぎ合わせていい感じにファイルを復元するもので，コンセプトとか説明は以下を読んだ方が良いっぽい．\nFile Carving - ForensicsWiki\nhttp://forensicswiki.org/wiki/File_Carving\nData Carving Concepts(pdf)\nhttps://www.sans.org/reading-room/whitepapers/forensics/data-carving-concepts-32969\n今回はSIFT Workstationに入っているforemostを使用する．他にもcarvingツールは色々あるっぽいので今度見てみる．\nForemost\nhttp://foremost.sourceforge.net/\n[socketo@siftworkstation:/vagrant_data/ashemery/Challenge02]$ foremost -t jpg,png,gif,doc,xls,pdf -i 4orensics03.001 -o ./output Processing: 4orensics03.001 *********************************************************************| 結果．指定していない拡張子も取られているので何かおかしい．\n実際にカービングして出力されたファイルを見る．\nfakeporn.7zに入っていたであろうと推測された動物の画像が復元されていることを確認することが出来た．\nノイズがかなりあるので，その点をどうにかしないといけなさそう．\nTimeLine とりあえずまとめ．\n何かを見落としている気がするので適宜訂正をしていきますのでゆるしてください．\n日時(UTC) 事象 ソース 備考 2016/06/21 00:36:56 EHPT MsgsがLinux rul3zへSkypeで内部情報の漏洩の補助の依頼 Skype log 2016/06/21 00:52:02 TeamViewerのインストーラをダウンロード WEB履歴(Chrome), USNJurnl 2016/06/21 01:00:31 ehptmsgs@gmail.com からlinux-rul3z@hotmail.comへ添付ファイル\"Pictures.7z\"を送信 Outlookメール 2016/06/21 01:00:?? EHPT MsgsからLinux rul3zへ\"Pictures.7z\"のパスワードをSkype経由で送信 メールの内容 推測:Skypeのメッセージが削除された可能性あり 2016/06/21 01:01:17 ehptmsgs@gmail.comからlinux-rul3z@hotmail.comへ拡張子を偽装したPDF機密ファイル\"Config.png\"を送信 Outlookメール 2016/06/21 10:51:21 TorBrowserのインストール Prefetch 実際のTor実行はFirefox.exe 2016/06/21 10:54:03 TorBrowserの実行 Prefetch 何かしらの匿名通信 2016/06/21 11:06:44 Hash Suite Freeの実行 UserAssist, Prefetch ハッシュからのパスワードの解析 2016/06/21 11:19:41 Pythonの実行 UserAssist, Prefetch 何かしらのスクリプトが実行された？ 2016/06/21 11:50:24 ehptmsgs@gmail.comからlinux-rul3z@hotmail.com, linux4rulez@gmail.comへ\"fakeporn.7z\"を送信 Outlookメール 動物の写真集 2016/06/21 12:02:35 BCWipeの実行 UserAssist, Prefetch 証跡の削除 2016/06/21 12:05:30 TeamViewerでの遠隔操作開始 TeamViewerログ 2016/06/21 12:08:14 Zenmapの実行．ポートスキャンの開始 Prefetch 45.33.32.156へポートスキャン 2016/06/21 12:13:15 ポートスキャンの実行結果nmapscan.xmlを保存 USNJrnl 2016/06/21 12:14:29 TeamViewerでの遠隔操終了 TeamViewerログ 2016/06/21 12:19:33 ehptmsgs@gmail.comからlinux-rul3z@hotmail.com, linux4rulez@gmail.comへネットワ画像の\"home-network-design-networking-for-a-single-family-home-case-house-arkko-1433-x-792.jpg\"の送信 Outlookメール 2016/06/21 12:28:08 CCleanerの実行 UserAssist, Prefetch 証跡の削除 2016/06/21 13:05:19 nmapscan.xmlを参照 USNJrnl, LNK 2016/06/21 13:16:00 プロジェクトの終了 メール内容 ",
  "wordCount" : "2518",
  "inLanguage": "en",
  "datePublished": "2018-02-19T09:06:57Z",
  "dateModified": "2018-02-19T09:06:57Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://socketo.github.io/posts/2018/02/19/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "socketo.github.io",
    "logo": {
      "@type": "ImageObject",
      "url": "https://socketo.github.io/images/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://socketo.github.io/" accesskey="h" title="socketo.github.io (Alt + H)">socketo.github.io</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://socketo.github.io/archives" title="archives">
                    <span><i class='fa fa-heart'></i>archives</span>
                </a>
            </li>
            <li>
                <a href="https://socketo.github.io/tags" title="tags">
                    <span><i class='fa fa-heart'></i>tags</span>
                </a>
            </li>
            <li>
                <a href="https://socketo.github.io/about" title="about">
                    <span><i class='fa fa-heart'></i>about</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Digital Forensic Challenge #2 - User Policy Violation Case Write up
    </h1>
    <div class="post-meta"><span title='2018-02-19 09:06:57 +0000 UTC'>February 19, 2018</span>&nbsp;·&nbsp;12 min

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e5%95%8f%e9%a1%8c%e6%96%87" aria-label="問題文">問題文</a></li>
                <li>
                    <a href="#%e8%aa%bf%e6%9f%bb%e7%92%b0%e5%a2%83%e3%83%84%e3%83%bc%e3%83%ab" aria-label="調査環境・ツール">調査環境・ツール</a></li>
                <li>
                    <a href="#%e8%aa%bf%e6%9f%bb" aria-label="調査">調査</a><ul>
                        
                <li>
                    <a href="#%e5%9f%ba%e6%9c%ac%e6%83%85%e5%a0%b1%e3%82%92%e8%aa%bf%e3%81%b9%e3%82%8b" aria-label="基本情報を調べる">基本情報を調べる</a><ul>
                        
                <li>
                    <a href="#os%e6%83%85%e5%a0%b1" aria-label="OS情報">OS情報</a></li>
                <li>
                    <a href="#timezone" aria-label="timezone">timezone</a></li>
                <li>
                    <a href="#computernamehostname" aria-label="ComputerName/Hostname">ComputerName/Hostname</a></li>
                <li>
                    <a href="#user%e7%a2%ba%e8%aa%8d" aria-label="User確認">User確認</a></li></ul>
                </li>
                <li>
                    <a href="#%e3%82%84%e3%82%8b" aria-label="やる">やる</a></li>
                <li>
                    <a href="#%e3%83%97%e3%83%ad%e3%82%b0%e3%83%a9%e3%83%a0%e5%ae%9f%e8%a1%8c%e5%b1%a5%e6%ad%b4" aria-label="プログラム実行履歴">プログラム実行履歴</a><ul>
                        
                <li>
                    <a href="#prefetch" aria-label="Prefetch">Prefetch</a></li>
                <li>
                    <a href="#userassist" aria-label="UserAssist">UserAssist</a></li></ul>
                </li>
                <li>
                    <a href="#usn%e3%82%b8%e3%83%a3%e3%83%bc%e3%83%8a%e3%83%ab%e3%81%ae%e8%a7%a3%e6%9e%90" aria-label="USNジャーナルの解析">USNジャーナルの解析</a></li>
                <li>
                    <a href="#lnk%e3%83%95%e3%82%a1%e3%82%a4%e3%83%ab%e8%a7%a3%e6%9e%90" aria-label="LNKファイル解析">LNKファイル解析</a></li>
                <li>
                    <a href="#skype" aria-label="Skype">Skype</a><ul>
                        
                <li>
                    <a href="#skype%e3%81%8b%e3%82%89%e5%88%86%e3%81%8b%e3%81%a3%e3%81%9f%e3%81%93%e3%81%a8%e3%81%a8%e6%8e%a8%e6%b8%ac" aria-label="Skypeから分かったことと推測">Skypeから分かったことと推測</a></li></ul>
                </li>
                <li>
                    <a href="#%e3%83%a1%e3%83%bc%e3%83%ab" aria-label="メール">メール</a><ul>
                        
                <li>
                    <a href="#%e3%83%a1%e3%83%bc%e3%83%ab%e3%81%ae%e3%82%bf%e3%82%a4%e3%83%a0%e3%83%a9%e3%82%a4%e3%83%b3" aria-label="メールのタイムライン">メールのタイムライン</a></li>
                <li>
                    <a href="#%e3%83%a1%e3%83%bc%e3%83%ab%e3%81%8b%e3%82%89%e5%88%86%e3%81%8b%e3%81%a3%e3%81%9f%e3%81%93%e3%81%a8%e3%81%a8%e6%8e%a8%e6%b8%ac" aria-label="メールから分かったことと推測">メールから分かったことと推測</a></li></ul>
                </li>
                <li>
                    <a href="#web%e5%b1%a5%e6%ad%b4" aria-label="WEB履歴">WEB履歴</a><ul>
                        
                <li>
                    <a href="#chrome" aria-label="Chrome">Chrome</a></li>
                <li>
                    <a href="#hangouts" aria-label="Hangouts">Hangouts</a><ul>
                        
                <li>
                    <a href="#chrome%e7%b5%8c%e7%94%b1%e3%81%a7%e3%83%80%e3%82%a6%e3%83%b3%e3%83%ad%e3%83%bc%e3%83%89%e3%81%95%e3%82%8c%e3%81%9f%e3%83%95%e3%82%a1%e3%82%a4%e3%83%ab" aria-label="Chrome経由でダウンロードされたファイル">Chrome経由でダウンロードされたファイル</a></li></ul>
                </li>
                <li>
                    <a href="#internetexploler" aria-label="InternetExploler">InternetExploler</a></li>
                <li>
                    <a href="#torbrowser" aria-label="TorBrowser">TorBrowser</a></li></ul>
                </li>
                <li>
                    <a href="#teamviewer" aria-label="TeamViewer">TeamViewer</a><ul>
                        
                <li>
                    <a href="#teamviewer%e3%81%8b%e3%82%89%e5%88%86%e3%81%8b%e3%81%a3%e3%81%9f%e3%81%93%e3%81%a8" aria-label="TeamViewerから分かったこと">TeamViewerから分かったこと</a></li>
                <li>
                    <a href="#teamviewer%e3%81%a7%e3%81%ae%e9%81%a0%e9%9a%94%e6%93%8d%e4%bd%9c%e6%99%82%e3%81%ae%e5%8b%95%e3%81%8d" aria-label="TeamViewerでの遠隔操作時の動き">TeamViewerでの遠隔操作時の動き</a><ul>
                        
                <li>
                    <a href="#prefetch%e3%81%8b%e3%82%89" aria-label="Prefetchから">Prefetchから</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#cloud%e3%82%b9%e3%83%88%e3%83%ac%e3%83%bc%e3%82%b8" aria-label="Cloudストレージ">Cloudストレージ</a></li>
                <li>
                    <a href="#pictures7z%e3%81%a8fakeporn7z%e3%81%ae%e4%b8%ad%e8%ba%ab%e3%82%92%e6%8e%a2%e3%81%99" aria-label="Pictures.7zとfakeporn.7zの中身を探す">Pictures.7zとfakeporn.7zの中身を探す</a><ul>
                        
                <li>
                    <a href="#pictures7z" aria-label="Pictures.7z">Pictures.7z</a></li>
                <li>
                    <a href="#fakeporn7z" aria-label="fakeporn.7z">fakeporn.7z</a></li></ul>
                </li>
                <li>
                    <a href="#filecarving" aria-label="FileCarving">FileCarving</a></li></ul>
                </li>
                <li>
                    <a href="#timeline" aria-label="TimeLine">TimeLine</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>※ 移行前の元ブログ記事 : <a href="https://socketo.hatenablog.jp/entry/2018/02/19/090657">Digital Forensic Challenge #2 - User Policy Violation Case Write up - #include &lt;sys_socket.h&gt;</a></p>
<p>本投稿の内容に間違いや問題などありましたら，Twitter経由などでやんわり優しめに教えて頂ければ幸いです．(Twitter:<a href="https://twitter.com/sys_socket">@sys_socket</a>)</p>
<p>恐らく何かしら間違ってたり，足りなかったりします．多分．
誰か教えてください．</p>
<p>はい．</p>
<p><a href="https://www.ashemery.com/dfir.html">https://www.ashemery.com/dfir.html</a> のChallenge #2</p>
<p>Case1はこちら
<a href="http://socketo.hatenablog.jp/entry/2018/02/05/032146">Digital Forensic Challenge #1 - Web Server Case Write up - socketo.hatenablog.jp</a></p>
<h2 id="問題文">問題文<a hidden class="anchor" aria-hidden="true" href="#問題文">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>This is another digital forensics image that was prepared to cover a full Windows Forensics course.
</span></span><span style="display:flex;"><span>System Image: here
</span></span><span style="display:flex;"><span>Hashes: here
</span></span><span style="display:flex;"><span>Password = here
</span></span><span style="display:flex;"><span>You can use the image to learn the following:
</span></span><span style="display:flex;"><span>File Carving, Custom Carving, and Keyword Searching
</span></span><span style="display:flex;"><span>File System Forensics - NTFS
</span></span><span style="display:flex;"><span>Deep Windows Registry Forensics: System and User Hives
</span></span><span style="display:flex;"><span>SYSTEM
</span></span><span style="display:flex;"><span>SOFTWARE
</span></span><span style="display:flex;"><span>SAM
</span></span><span style="display:flex;"><span>NTUSER.DAT
</span></span><span style="display:flex;"><span>USRCLASS.DAT
</span></span><span style="display:flex;"><span>Other Windows Files: LNK, Jump Lists, Libraries, etc
</span></span><span style="display:flex;"><span>Application Compatibility Cache (ShimCache)
</span></span><span style="display:flex;"><span>Analyzing Windows Search (Search Charm)
</span></span><span style="display:flex;"><span>Analyzing Thumb Caches
</span></span><span style="display:flex;"><span>Analyzing Prefetch Files
</span></span><span style="display:flex;"><span>Analyzing Recycle Bin(s)
</span></span><span style="display:flex;"><span>USB Forensics
</span></span><span style="display:flex;"><span>Events Analysis
</span></span><span style="display:flex;"><span>Email Forensics: Web and Outlook
</span></span><span style="display:flex;"><span>Browser Forensics: Internet Explorer and Google Chrome
</span></span><span style="display:flex;"><span>Skype Forensics
</span></span><span style="display:flex;"><span>This image covers most if not all of the recent system artifacts that you might encounter. Let me know if you need any help or if you are an instructor and want the answers to each part of the case. I will only send the answers to verified instructors.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Due to lots of requests, I have decided to compile a manual or a book for the second image with Q&amp;As to help you go through the challenge and solve every part of it. URLs and further explanations will be provided very soon. Stay tuned my friends and happy hunting ;)
</span></span></code></pre></div><p>このイメージで以下のことが学べるらしい</p>
<ol>
<li>
<p>ファイルカービング，カスタムカービング，キーワード検索</p>
</li>
<li>
<p>ファイルシステムフォレンジック - NTFS</p>
</li>
<li>
<p>Deep Windows レジストリフォレンジック:システムとユーザのハイブ</p>
<ul>
<li>SYSTEM</li>
<li>SOFTWARE</li>
<li>SAM</li>
<li>NTUSER.DAT</li>
<li>USRCLASS.DAT</li>
</ul>
</li>
<li>
<p>その他のWindowsファイル:LNK，ジャンプリスト，ライブラリなど</p>
</li>
<li>
<p>ShimCache</p>
</li>
<li>
<p>Windows検索の分析</p>
</li>
<li>
<p>Thumbキャッシュの分析</p>
</li>
<li>
<p>Prefetchファイルの分析</p>
</li>
<li>
<p>ゴミ箱の分析</p>
</li>
<li>
<p>USBフォレンジック</p>
</li>
<li>
<p>イベント分析</p>
</li>
<li>
<p>電子メールフォレンジック:WebとOutlook</p>
</li>
<li>
<p>Webブラウザフォレンジック:Internet Exploler, Google Chrome</p>
</li>
<li>
<p>Skypeフォレンジック</p>
</li>
</ol>
<p>***</p>
<h2 id="調査環境ツール">調査環境・ツール<a hidden class="anchor" aria-hidden="true" href="#調査環境ツール">#</a></h2>
<p>有償ツールは使わない流れでいきます．</p>
<ul>
<li>
<p>FTK(R) Imager 3.2.0 : <a href="http://marketing.accessdata.com/ftkimager3.2.0">http://marketing.accessdata.com/ftkimager3.2.0</a></p>
</li>
<li>
<p>SIFT CLI : <a href="https://github.com/sans-dfir/sift-cli">https://github.com/sans-dfir/sift-cli</a></p>
<ul>
<li>RegRIpper : <a href="https://github.com/keydet89/RegRipper2.8">https://github.com/keydet89/RegRipper2.8</a></li>
<li>Volatility : <a href="https://github.com/volatilityfoundation/volatility">https://github.com/volatilityfoundation/volatility</a></li>
<li>foremost : <a href="http://foremost.sourceforge.net/">http://foremost.sourceforge.net/</a></li>
</ul>
</li>
<li>
<p>WinPrefetchView : <a href="http://www.nirsoft.net/utils/win_prefetch_view.html">http://www.nirsoft.net/utils/win_prefetch_view.html</a></p>
</li>
<li>
<p>USNAnalytics : <a href="https://www.kazamiya.net/usn_analytics">https://www.kazamiya.net/usn_analytics</a></p>
</li>
<li>
<p>HindSight : <a href="https://github.com/obsidianforensics/hindsight">https://github.com/obsidianforensics/hindsight</a></p>
</li>
<li>
<p>DB Browser for SQLite : <a href="http://sqlitebrowser.org/">http://sqlitebrowser.org/</a></p>
</li>
<li>
<p>XstReader : <a href="https://github.com/Dijji/XstReader">https://github.com/Dijji/XstReader</a></p>
</li>
<li>
<p>PSTWalker : <a href="https://pstwalker.com/">https://pstwalker.com/</a></p>
</li>
<li>
<p>NetworkUsageView : <a href="https://www.nirsoft.net/utils/network_usage_view.html">https://www.nirsoft.net/utils/network_usage_view.html</a></p>
</li>
</ul>
<h2 id="調査">調査<a hidden class="anchor" aria-hidden="true" href="#調査">#</a></h2>
<h3 id="基本情報を調べる">基本情報を調べる<a hidden class="anchor" aria-hidden="true" href="#基本情報を調べる">#</a></h3>
<p>Case1と同じでregripperを使用して，各基本情報を調べる</p>
<h4 id="os情報">OS情報<a hidden class="anchor" aria-hidden="true" href="#os情報">#</a></h4>
<table>
  <thead>
      <tr>
          <th>OS</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Windows 8.1 Enterprise</td>
      </tr>
  </tbody>
</table>
<h4 id="timezone">timezone<a hidden class="anchor" aria-hidden="true" href="#timezone">#</a></h4>
<p>前回と同じくUTC-7なことを確認</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>[vagrant@siftworkstation:/vagrant_data/ashemery/Challenge02/reg]$ rip.pl -r SYSTEM -p timezone
</span></span><span style="display:flex;"><span>Launching timezone v.20160318
</span></span><span style="display:flex;"><span>timezone v.20160318
</span></span><span style="display:flex;"><span>(System) Get TimeZoneInformation key contents
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TimeZoneInformation key
</span></span><span style="display:flex;"><span>ControlSet001\Control\TimeZoneInformation
</span></span><span style="display:flex;"><span>LastWrite Time Tue Jun 21 09:14:37 2016 (UTC)
</span></span><span style="display:flex;"><span>DaylightName   -&gt; @tzres.dll,-211
</span></span><span style="display:flex;"><span>StandardName   -&gt; @tzres.dll,-212
</span></span><span style="display:flex;"><span>Bias           -&gt; 480 (8 hours)
</span></span><span style="display:flex;"><span>ActiveTimeBias -&gt; 420 (7 hours)
</span></span><span style="display:flex;"><span>TimeZoneKeyName-&gt; Pacific Standard Time
</span></span></code></pre></div><h4 id="computernamehostname">ComputerName/Hostname<a hidden class="anchor" aria-hidden="true" href="#computernamehostname">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>[vagrant@siftworkstation:/vagrant_data/ashemery/Challenge02/reg]$ rip.pl -r SYSTEM -p compname
</span></span><span style="display:flex;"><span>Launching compname v.20090727
</span></span><span style="display:flex;"><span>compname v.20090727
</span></span><span style="display:flex;"><span>(System) Gets ComputerName and Hostname values from System hive
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ComputerName    = 4ORENSICS
</span></span><span style="display:flex;"><span>TCP/IP Hostname = 4orensics
</span></span></code></pre></div><h4 id="user確認">User確認<a hidden class="anchor" aria-hidden="true" href="#user確認">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>[vagrant@siftworkstation:/vagrant_data/ashemery/Challenge02/reg]$ rip.pl -r SAM -p samparse
</span></span><span style="display:flex;"><span>Launching samparse v.20160203
</span></span><span style="display:flex;"><span>samparse v.20160203
</span></span><span style="display:flex;"><span>(SAM) Parse SAM file for user &amp; group mbrshp info
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User Information
</span></span><span style="display:flex;"><span>-------------------------
</span></span><span style="display:flex;"><span>Username        : Administrator [500]
</span></span><span style="display:flex;"><span>Full Name       :
</span></span><span style="display:flex;"><span>User Comment    : Built-in account for administering the computer/domain
</span></span><span style="display:flex;"><span>Account Type    : Default Admin User
</span></span><span style="display:flex;"><span>Account Created : Tue Jun 21 08:19:47 2016 Z
</span></span><span style="display:flex;"><span>Name            :
</span></span><span style="display:flex;"><span>Last Login Date : Tue Mar 18 10:20:36 2014 Z
</span></span><span style="display:flex;"><span>Pwd Reset Date  : Tue Mar 18 10:20:39 2014 Z
</span></span><span style="display:flex;"><span>Pwd Fail Date   : Never
</span></span><span style="display:flex;"><span>Login Count     : 3
</span></span><span style="display:flex;"><span>--&gt; Normal user account
</span></span><span style="display:flex;"><span>--&gt; Password does not expire
</span></span><span style="display:flex;"><span>--&gt; Account Disabled
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Username        : Guest [501]
</span></span><span style="display:flex;"><span>Full Name       :
</span></span><span style="display:flex;"><span>User Comment    : Built-in account for guest access to the computer/domain
</span></span><span style="display:flex;"><span>Account Type    : Default Guest Acct
</span></span><span style="display:flex;"><span>Account Created : Tue Jun 21 08:19:47 2016 Z
</span></span><span style="display:flex;"><span>Name            :
</span></span><span style="display:flex;"><span>Last Login Date : Never
</span></span><span style="display:flex;"><span>Pwd Reset Date  : Never
</span></span><span style="display:flex;"><span>Pwd Fail Date   : Never
</span></span><span style="display:flex;"><span>Login Count     : 0
</span></span><span style="display:flex;"><span>--&gt; Normal user account
</span></span><span style="display:flex;"><span>--&gt; Password does not expire
</span></span><span style="display:flex;"><span>--&gt; Password not required
</span></span><span style="display:flex;"><span>--&gt; Account Disabled
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Username        : Hunter [1001]
</span></span><span style="display:flex;"><span>Full Name       :
</span></span><span style="display:flex;"><span>User Comment    :
</span></span><span style="display:flex;"><span>Account Type    : Default Admin User
</span></span><span style="display:flex;"><span>Account Created : Tue Jun 21 08:37:43 2016 Z
</span></span><span style="display:flex;"><span>Name            :
</span></span><span style="display:flex;"><span>Password Hint   : What do you do?
</span></span><span style="display:flex;"><span>Last Login Date : Tue Jun 21 01:42:40 2016 Z
</span></span><span style="display:flex;"><span>Pwd Reset Date  : Tue Jun 21 08:37:43 2016 Z
</span></span><span style="display:flex;"><span>Pwd Fail Date   : Tue Jun 21 12:53:04 2016 Z
</span></span><span style="display:flex;"><span>Login Count     : 3
</span></span><span style="display:flex;"><span>--&gt; Normal user account
</span></span><span style="display:flex;"><span>--&gt; Password does not expire
</span></span><span style="display:flex;"><span>--&gt; Password not required
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Username        : HomeGroupUser$ [1003]
</span></span><span style="display:flex;"><span>Full Name       : HomeGroupUser$
</span></span><span style="display:flex;"><span>User Comment    : Built-in account for homegroup access to the computer
</span></span><span style="display:flex;"><span>Account Type    : Custom Limited Acct
</span></span><span style="display:flex;"><span>Account Created : Tue Jun 21 08:40:06 2016 Z
</span></span><span style="display:flex;"><span>Name            :
</span></span><span style="display:flex;"><span>Last Login Date : Never
</span></span><span style="display:flex;"><span>Pwd Reset Date  : Tue Jun 21 08:40:06 2016 Z
</span></span><span style="display:flex;"><span>Pwd Fail Date   : Never
</span></span><span style="display:flex;"><span>Login Count     : 0
</span></span><span style="display:flex;"><span>--&gt; Normal user account
</span></span><span style="display:flex;"><span>--&gt; Password does not expire
</span></span></code></pre></div><h3 id="やる">やる<a hidden class="anchor" aria-hidden="true" href="#やる">#</a></h3>
<p>&ldquo;User Policy Violation&quot;とのことなので，適当に見る．</p>
<h3 id="プログラム実行履歴">プログラム実行履歴<a hidden class="anchor" aria-hidden="true" href="#プログラム実行履歴">#</a></h3>
<h4 id="prefetch">Prefetch<a hidden class="anchor" aria-hidden="true" href="#prefetch">#</a></h4>
<p>アプリケーション起動速度を速める為にWindows XP以降に実装された仕組み．</p>
<p>詳しい話は以下のブログにて色々と書いてあるので参考に．</p>
<p>簡易解析入門 プログラム実行の痕跡の調査 (1)Prefetch: セクタンラボ 実験日誌
<a href="http://sectanlab.sblo.jp/article/115076023.html">http://sectanlab.sblo.jp/article/115076023.html</a></p>
<p>上のブログと同じように，<a href="http://www.nirsoft.net/utils/win_prefetch_view.html">WinPrefetchView</a>を使う．</p>
<p>FTK Imagerで<code>C:\Windows\Prefetch</code>フォルダをExportして，メニューから<code>Options</code>-<code>Advanced Options</code>を選択しExportしてきたPrefetchフォルダを読み込ませる．</p>
<p>※WinPrefetchViewはデフォルトの表示時間がローカルタイムになってしまうので，<code>Options</code>-<code>Show Time in GMT</code>のチェックを入れるようにする．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219014432p:plain" loading="lazy" src="/posts/2018/02/19/20180219014432.png" title="f:id:socketo:20180219014432p:plain"><!-- raw HTML omitted --></p>
<p><code>User Policy Violation</code>というケースタイトルなので，内部不正を行う時に使用しそうなっぽいソフトウェアとか普通のユーザが入れないソフトウェアっぽいのをとりあえず列挙する．</p>
<ul>
<li>CCleaner</li>
<li>Dropbox</li>
<li>FTK Imager</li>
<li>Outlook</li>
<li>Python</li>
<li>Skype</li>
<li>TorBrowser installer</li>
<li>Wireshark</li>
<li>Zenmap</li>
</ul>
<h4 id="userassist">UserAssist<a hidden class="anchor" aria-hidden="true" href="#userassist">#</a></h4>
<p>Exploler経由で起動したアプリケーションが<code>　HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist</code>に保存されている．regedit.exeで見るとROT13しているが，RegistryExplorlerで見るといい感じにROT13を復号してくれている．</p>
<p>いい感じにregripperでuserassistプラグインを使用し，実行履歴を出す．</p>
<p>色々と実行してる．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>[socketo@siftworkstation:/vagrant_data/ashemery/Challenge02]$ rip.pl -r reg/NTUSER.DAT -p userassist
</span></span><span style="display:flex;"><span>～省略～
</span></span><span style="display:flex;"><span>{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}
</span></span><span style="display:flex;"><span>Tue Jun 21 12:29:55 2016 Z
</span></span><span style="display:flex;"><span>C:\Users\Hunter\Downloads\FTK-Imager\FTK Imager.exe (2)
</span></span><span style="display:flex;"><span>Tue Jun 21 12:28:08 2016 Z
</span></span><span style="display:flex;"><span>{6D809377-6AF0-444B-8957-A3773F02200E}\CCleaner\CCleaner64.exe (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 12:26:30 2016 Z
</span></span><span style="display:flex;"><span>{6D809377-6AF0-444B-8957-A3773F02200E}\Microsoft Office\Office15\WINWORD.EXE (2)
</span></span><span style="display:flex;"><span>Tue Jun 21 12:26:17 2016 Z
</span></span><span style="display:flex;"><span>C:\Python27\pythonw.exe (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 12:08:13 2016 Z
</span></span><span style="display:flex;"><span>{7C5A40EF-A0FB-4BFC-874A-C0F2E0B9FA8E}\Nmap\zenmap.exe (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 12:02:35 2016 Z
</span></span><span style="display:flex;"><span>{7C5A40EF-A0FB-4BFC-874A-C0F2E0B9FA8E}\Jetico\BCWipe\BCWipe.exe (2)
</span></span><span style="display:flex;"><span>Tue Jun 21 12:01:44 2016 Z
</span></span><span style="display:flex;"><span>{6D809377-6AF0-444B-8957-A3773F02200E}\CCleaner\ccleaner.exe (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 12:00:43 2016 Z
</span></span><span style="display:flex;"><span>{7C5A40EF-A0FB-4BFC-874A-C0F2E0B9FA8E}\TeamViewer\TeamViewer.exe (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 11:55:37 2016 Z
</span></span><span style="display:flex;"><span>C:\Users\Hunter\Downloads\putty.exe (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 11:54:48 2016 Z
</span></span><span style="display:flex;"><span>C:\Users\Hunter\Downloads\SysinternalsSuite\Procmon.exe (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 11:54:45 2016 Z
</span></span><span style="display:flex;"><span>{F38BF404-1D43-42F2-9305-67DE0B28FC23}\hh.exe (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 11:54:36 2016 Z
</span></span><span style="display:flex;"><span>C:\Users\Hunter\Downloads\SysinternalsSuite\procexp.exe (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 11:52:06 2016 Z
</span></span><span style="display:flex;"><span>{1AC14E77-02E7-4E5D-B744-2EB1AE5198B7}\notepad.exe (3)
</span></span><span style="display:flex;"><span>Tue Jun 21 11:51:23 2016 Z
</span></span><span style="display:flex;"><span>windows.immersivecontrolpanel_cw5n1h2txyewy!microsoft.windows.immersivecontrolpanel (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 11:44:32 2016 Z
</span></span><span style="display:flex;"><span>C:\Users\Hunter\Downloads\bcwipeSetup.exe (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 11:44:16 2016 Z
</span></span><span style="display:flex;"><span>C:\Users\Hunter\Downloads\ccsetup519pro.exe (2)
</span></span><span style="display:flex;"><span>Tue Jun 21 11:38:46 2016 Z
</span></span><span style="display:flex;"><span>{6D809377-6AF0-444B-8957-A3773F02200E}\Java\jre1.8.0_91\bin\javaw.exe (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 11:19:14 2016 Z
</span></span><span style="display:flex;"><span>C:\Users\Hunter\Downloads\python-3.5.1.exe (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 11:17:58 2016 Z
</span></span><span style="display:flex;"><span>{1AC14E77-02E7-4E5D-B744-2EB1AE5198B7}\msiexec.exe (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 11:06:44 2016 Z
</span></span><span style="display:flex;"><span>C:\Users\Hunter\Downloads\Hash_Suite_Free\Hash_Suite_64.exe (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 09:28:21 2016 Z
</span></span><span style="display:flex;"><span>D:\VBoxWindowsAdditions.exe (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 09:27:00 2016 Z
</span></span><span style="display:flex;"><span>{7C5A40EF-A0FB-4BFC-874A-C0F2E0B9FA8E}\Google\Chrome\Application\chrome.exe (2)
</span></span><span style="display:flex;"><span>Tue Jun 21 08:41:33 2016 Z
</span></span><span style="display:flex;"><span>C:\Users\Hunter\Downloads\ChromeSetup.exe (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 08:38:47 2016 Z
</span></span><span style="display:flex;"><span>Microsoft.InternetExplorer.Default (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 02:00:01 2016 Z
</span></span><span style="display:flex;"><span>{7C5A40EF-A0FB-4BFC-874A-C0F2E0B9FA8E}\Adobe\Acrobat Reader DC\Reader\AcroRd32.exe (5)
</span></span><span style="display:flex;"><span>Tue Jun 21 01:51:06 2016 Z
</span></span><span style="display:flex;"><span>Dropbox.Desktop.Client (1)
</span></span><span style="display:flex;"><span>Tue Jun 21 01:43:24 2016 Z
</span></span><span style="display:flex;"><span>Chrome (3)
</span></span><span style="display:flex;"><span>Mon Jun 20 23:53:36 2016 Z
</span></span><span style="display:flex;"><span>{1AC14E77-02E7-4E5D-B744-2EB1AE5198B7}\cmd.exe (1)
</span></span></code></pre></div><h3 id="usnジャーナルの解析">USNジャーナルの解析<a hidden class="anchor" aria-hidden="true" href="#usnジャーナルの解析">#</a></h3>
<p>Case1と同じく，<a href="https://www.kazamiya.net/usn_analytics">USNAnalytics</a>を使用．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219014738p:plain" loading="lazy" src="/posts/2018/02/19/20180219014738.png" title="f:id:socketo:20180219014738p:plain"><!-- raw HTML omitted --></p>
<p>各アーティファクトで出てきた結果とかの裏付けとかで適宜確認する．</p>
<h3 id="lnkファイル解析">LNKファイル解析<a hidden class="anchor" aria-hidden="true" href="#lnkファイル解析">#</a></h3>
<p>LNKファイルはWindowsのショートカットファイルの拡張子で，ユーザがファイル，ドキュメントを開いた際にLNKファイルが生成されるので触ったファイルが分かる．</p>
<p><code>C:\Users\{username}\AppData\Roaming\Microsoft\Windows\Recent</code>に.lnkファイルが生成される．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219014800p:plain" loading="lazy" src="/posts/2018/02/19/20180219014800.png" title="f:id:socketo:20180219014800p:plain"><!-- raw HTML omitted --></p>
<p>中を見てみると，左側にバツマークがついており削除されていることが分かる
．
ユーザが意図的に消したか，CCleanerのような最適化ツールによって削除したかなど考えられる．</p>
<h3 id="skype">Skype<a hidden class="anchor" aria-hidden="true" href="#skype">#</a></h3>
<p>Skypeについて見ていく．</p>
<p>Skypeのアーティファクトについては以下を参考．</p>
<p>Skype Forensics: Analyzing Call and Chat Data From Computers and Mobile(pdf) : <a href="https://www.magnetforensics.com/wp-content/uploads/2014/04/Skype-Forensics-Analyzing-Call-and-Chat-Data-From-Computers-and-Mobile-Magnet-Forensics.pdf">https://www.magnetforensics.com/wp-content/uploads/2014/04/Skype-Forensics-Analyzing-Call-and-Chat-Data-From-Computers-and-Mobile-Magnet-Forensics.pdf</a></p>
<p><code>Users/Hunter/AppData/Roaming/Skype/hunterhpt/</code>ディレクトリをFTK ImagerでExportする．</p>
<p><code>Users/Hunter/AppData/Roaming/Skype/hunterhpt/main.db</code>に実際のSkypeの色々が格納されている．
<!-- raw HTML omitted --><img alt="f:id:socketo:20180219014831p:plain" loading="lazy" src="/posts/2018/02/19/20180219014831.png" title="f:id:socketo:20180219014831p:plain"><!-- raw HTML omitted --></p>
<p>まずアカウント情報を見ていく．</p>
<p>アカウント情報は<code>Accounts</code>テーブルに格納されている．</p>
<p>このSkypeを利用していたMicrosoftアカウントのメールアドレスが<code>ehptmsgs@gmail.com</code>ということがわかる．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219014902p:plain" loading="lazy" src="/posts/2018/02/19/20180219014902.png" title="f:id:socketo:20180219014902p:plain"><!-- raw HTML omitted --></p>
<p>次にチャットメッセージを見る．</p>
<p>チャットメッセージは<code>Messages</code>テーブルに格納されている．
<!-- raw HTML omitted --><img alt="f:id:socketo:20180219014924p:plain" loading="lazy" src="/posts/2018/02/19/20180219014924.png" title="f:id:socketo:20180219014924p:plain"><!-- raw HTML omitted --></p>
<p>一応，見れるが文字コードとかがおかしいのか中身を読めない．</p>
<p>Skypeのログを見る便利なツールがあるので，これに頼る．</p>
<p>Skype Log Viewer : <a href="http://www.nirsoft.net/utils/skype_log_view.html">http://www.nirsoft.net/utils/skype_log_view.html</a></p>
<p>Exportした<code>Users/Hunter/AppData/Roaming/Skype/hunterhpt/</code>を読み込ませるといい感じに表示してくれる．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219014957p:plain" loading="lazy" src="/posts/2018/02/19/20180219014957.png" title="f:id:socketo:20180219014957p:plain"><!-- raw HTML omitted --></p>
<p>見やすいように時系列順に会話を並べて形成する．</p>
<p>(多分ローカルのTimezoneに合わせられているので-9にしてUTCに直す)</p>
<p>会話ログ原文</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>datetime Display Name    Chat Message
</span></span><span style="display:flex;"><span>2016/06/21 00:36:56 EHPT Msgs   hello
</span></span><span style="display:flex;"><span>2016/06/21 00:37:02 Linux rul3z hello
</span></span><span style="display:flex;"><span>2016/06/21 00:37:37 EHPT Msgs   I have some pics that need to send outside my network
</span></span><span style="display:flex;"><span>2016/06/21 00:37:54 EHPT Msgs   but the problem is that our network is monitored
</span></span><span style="display:flex;"><span>2016/06/21 00:38:32 EHPT Msgs   I need to bypass their censorships
</span></span><span style="display:flex;"><span>2016/06/21 00:38:53 EHPT Msgs   also I need to get access to documents and send them
</span></span><span style="display:flex;"><span>2016/06/21 00:39:04 EHPT Msgs   so I am asking for your help
</span></span><span style="display:flex;"><span>2016/06/21 00:39:10 Linux rul3z hmm
</span></span><span style="display:flex;"><span>2016/06/21 00:39:16 Linux rul3z what kind of pics?
</span></span><span style="display:flex;"><span>2016/06/21 00:39:30 Linux rul3z and what is the type of docs u need to send outside?
</span></span><span style="display:flex;"><span>2016/06/21 00:39:42 EHPT Msgs   the pics are something special
</span></span><span style="display:flex;"><span>2016/06/21 00:40:03 EHPT Msgs   some of the docs are for products
</span></span><span style="display:flex;"><span>2016/06/21 00:40:16 EHPT Msgs   others are for other misc stuff
</span></span><span style="display:flex;"><span>2016/06/21 00:40:30 Linux rul3z no worries
</span></span><span style="display:flex;"><span>2016/06/21 00:40:55 Linux rul3z let us work on them separately
</span></span><span style="display:flex;"><span>2016/06/21 00:41:03 EHPT Msgs   what do you mean?
</span></span><span style="display:flex;"><span>2016/06/21 00:41:15 Linux rul3z I mean, let us first find away to access your device
</span></span><span style="display:flex;"><span>2016/06/21 00:41:31 Linux rul3z and then, see what can we do in order to exfil the docs/pics outside ur network
</span></span><span style="display:flex;"><span>2016/06/21 00:41:33 EHPT Msgs   ok
</span></span><span style="display:flex;"><span>2016/06/21 00:41:37 EHPT Msgs   that sounds great
</span></span><span style="display:flex;"><span>2016/06/21 00:41:43 EHPT Msgs   but is this truly doable?
</span></span><span style="display:flex;"><span>2016/06/21 00:41:47 Linux rul3z there is no limits
</span></span><span style="display:flex;"><span>2016/06/21 00:41:51 Linux rul3z sure it is &lt;ss type=&#34;wink&#34;&gt;;)&lt;/ss&gt;
</span></span><span style="display:flex;"><span>2016/06/21 00:41:59 EHPT Msgs   when shall we start
</span></span><span style="display:flex;"><span>2016/06/21 00:42:00 EHPT Msgs   ?
</span></span><span style="display:flex;"><span>2016/06/21 00:42:12 Linux rul3z Can I access your machine?
</span></span><span style="display:flex;"><span>2016/06/21 00:42:26 EHPT Msgs   hmm, not sure since our network is monitored as I told u
</span></span><span style="display:flex;"><span>2016/06/21 00:42:33 Linux rul3z okay wait
</span></span><span style="display:flex;"><span>2016/06/21 00:47:17 Linux rul3z can you install team viewer?
</span></span><span style="display:flex;"><span>2016/06/21 00:47:36 EHPT Msgs   I am not sure
</span></span><span style="display:flex;"><span>2016/06/21 00:47:39 EHPT Msgs   but let me see
</span></span><span style="display:flex;"><span>2016/06/21 00:47:47 EHPT Msgs   I will inform you once I am finished
</span></span><span style="display:flex;"><span>2016/06/21 00:47:51 EHPT Msgs   how can I reach u?
</span></span><span style="display:flex;"><span>2016/06/21 00:48:12 Linux rul3z send an email to my Hotmail account
</span></span><span style="display:flex;"><span>2016/06/21 00:48:17 EHPT Msgs   which one?
</span></span><span style="display:flex;"><span>2016/06/21 00:48:25 Linux rul3z same as Skype &lt;ss type=&#34;wink&#34;&gt;;)&lt;/ss&gt;
</span></span><span style="display:flex;"><span>2016/06/21 00:48:32 EHPT Msgs   ok &lt;ss type=&#34;laugh&#34;&gt;:D&lt;/ss&gt;
</span></span><span style="display:flex;"><span>2016/06/21 00:48:34 EHPT Msgs   understood
</span></span><span style="display:flex;"><span>2016/06/21 00:48:46 EHPT Msgs   see you soon
</span></span><span style="display:flex;"><span>2016/06/21 00:48:52 Linux rul3z yeah
</span></span><span style="display:flex;"><span>2016/06/21 00:48:54 EHPT Msgs   bye bye
</span></span><span style="display:flex;"><span>2016/06/21 00:48:56 Linux rul3z bye
</span></span><span style="display:flex;"><span>2016/06/21 11:48:37 EHPT Msgs   &lt;URIObject type=&#34;File.1&#34; uri=&#34;https://api.asm.skype.com/v1/objects/0-weu-d2-a958c1f0bec3eaa30bcef8d795c8ff63&#34; url_thumbnail=&#34;https://api.asm.skype.com/v1/objects/0-weu-d2-a958c1f0bec3eaa30bcef8d795c8ff63/views/thumbnail&#34;&gt;To view this shared file, go to: &lt;Title&gt;fakeporn.7z&lt;/Title&gt; &lt;Description&gt;fakeporn.7z&lt;/Description&gt; &lt;a href=&#34;https://login.skype.com/login/sso?go=webclient.xmm&amp;amp;docid=0-weu-d2-a958c1f0bec3eaa30bcef8d795c8ff63&#34;&gt;https://login.skype.com/login/sso?go=webclient.xmm&amp;amp;docid=0-weu-d2-a958c1f0bec3eaa30bcef8d795c8ff63&lt;/a&gt;&lt;FileSize v=&#34;750184&#34; /&gt;&lt;OriginalName v=&#34;fakeporn.7z&#34; /&gt;&lt;/URIObject&gt;
</span></span><span style="display:flex;"><span>2016/06/21 11:48:46 EHPT Msgs   Nice pics&lt;ss type=&#34;wink&#34;&gt;;)&lt;/ss&gt;
</span></span></code></pre></div><p>会話ログ意訳(日時UTC)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>datetime Display Name    Chat Message
</span></span><span style="display:flex;"><span>2016/06/21 00:36:56 EHPT Msgs   ハロー
</span></span><span style="display:flex;"><span>2016/06/21 00:37:02 Linux rul3z ハロー
</span></span><span style="display:flex;"><span>2016/06/21 00:37:37 EHPT Msgs   私はネットワークの外に送信する必要がある幾つかの写真を持ってる
</span></span><span style="display:flex;"><span>2016/06/21 00:37:54 EHPT Msgs   でも問題としてネットワークが監視されている
</span></span><span style="display:flex;"><span>2016/06/21 00:38:32 EHPT Msgs   私はその検閲を回避する必要がある
</span></span><span style="display:flex;"><span>2016/06/21 00:38:53 EHPT Msgs   さらに私はドキュメントにアクセスしてそれらを送信する必要がある
</span></span><span style="display:flex;"><span>2016/06/21 00:39:04 EHPT Msgs   だから私はあなたに助けを求めている
</span></span><span style="display:flex;"><span>2016/06/21 00:39:10 Linux rul3z ウーン…
</span></span><span style="display:flex;"><span>2016/06/21 00:39:16 Linux rul3z どんな写真？
</span></span><span style="display:flex;"><span>2016/06/21 00:39:30 Linux rul3z ネットワークの外に送信する必要があるドキュメントのタイプは何？
</span></span><span style="display:flex;"><span>2016/06/21 00:39:42 EHPT Msgs   写真はスペシャルなもの
</span></span><span style="display:flex;"><span>2016/06/21 00:40:03 EHPT Msgs   いくつかのドキュメントはプロダクト用
</span></span><span style="display:flex;"><span>2016/06/21 00:40:16 EHPT Msgs   その他は他の資料
</span></span><span style="display:flex;"><span>2016/06/21 00:40:30 Linux rul3z 心配ない
</span></span><span style="display:flex;"><span>2016/06/21 00:40:55 Linux rul3z それらは個々に作業をしよう
</span></span><span style="display:flex;"><span>2016/06/21 00:41:03 EHPT Msgs   どういう意味？
</span></span><span style="display:flex;"><span>2016/06/21 00:41:15 Linux rul3z とういうのは，まず私達にあなたのデバイスにアクセスさせてください
</span></span><span style="display:flex;"><span>2016/06/21 00:41:31 Linux rul3z そして，あなたのネットワークの外にドキュメント/写真がexfil(対象を外的環境から奪取す?)るのを見てください
</span></span><span style="display:flex;"><span>2016/06/21 00:41:33 EHPT Msgs   ok
</span></span><span style="display:flex;"><span>2016/06/21 00:41:37 EHPT Msgs   それは良いです
</span></span><span style="display:flex;"><span>2016/06/21 00:41:43 EHPT Msgs   これは本当に実践できるだろうか？
</span></span><span style="display:flex;"><span>2016/06/21 00:41:47 Linux rul3z ここに制限は無い
</span></span><span style="display:flex;"><span>2016/06/21 00:41:51 Linux rul3z もちろん;)
</span></span><span style="display:flex;"><span>2016/06/21 00:41:59 EHPT Msgs   いつはじめますか
</span></span><span style="display:flex;"><span>2016/06/21 00:42:00 EHPT Msgs   ?
</span></span><span style="display:flex;"><span>2016/06/21 00:42:12 Linux rul3z 私はあなたのマシンにアクセスできますか？
</span></span><span style="display:flex;"><span>2016/06/21 00:42:26 EHPT Msgs   うーん，言ったようにネットワークは監視されているので
</span></span><span style="display:flex;"><span>2016/06/21 00:42:33 Linux rul3z オーケー，待って
</span></span><span style="display:flex;"><span>2016/06/21 00:47:17 Linux rul3z TeamViewerはインストールできる？
</span></span><span style="display:flex;"><span>2016/06/21 00:47:36 EHPT Msgs   よくわかりませんが
</span></span><span style="display:flex;"><span>2016/06/21 00:47:39 EHPT Msgs   そうですね
</span></span><span style="display:flex;"><span>2016/06/21 00:47:47 EHPT Msgs   終わったら知らせます
</span></span><span style="display:flex;"><span>2016/06/21 0047:51  EHPT Msgs   どのようにしてあなたにとどけることができますか？
</span></span><span style="display:flex;"><span>2016/06/21 00:48:12 Linux rul3z 私のHotmailアカウントにメールを送ってください
</span></span><span style="display:flex;"><span>2016/06/21 00:48:17 EHPT Msgs   どれ？
</span></span><span style="display:flex;"><span>2016/06/21 00:48:25 Linux rul3z Skypeと同じ;)
</span></span><span style="display:flex;"><span>2016/06/21 00:48:32 EHPT Msgs   ok :D
</span></span><span style="display:flex;"><span>2016/06/21 00:48:34 EHPT Msgs   理解した
</span></span><span style="display:flex;"><span>2016/06/21 00:48:46 EHPT Msgs   また近いうちに
</span></span><span style="display:flex;"><span>2016/06/21 00:48:52 Linux rul3z yeah
</span></span><span style="display:flex;"><span>2016/06/21 00:48:54 EHPT Msgs   bye bye
</span></span><span style="display:flex;"><span>2016/06/21 00:48:56 Linux rul3z bye
</span></span><span style="display:flex;"><span>2016/06/21 11:48:37 EHPT Msgs   &lt;URIObject type=&#34;File.1&#34; uri=&#34;https://api.asm.skype.com/v1/objects/0-weu-d2-a958c1f0bec3eaa30bcef8d795c8ff63&#34; url_thumbnail=&#34;https://api.asm.skype.com/v1/objects/0-weu-d2-a958c1f0bec3eaa30bcef8d795c8ff63/views/thumbnail&#34;&gt;To view this shared file, go to: &lt;Title&gt;fakeporn.7z&lt;/Title&gt; &lt;Description&gt;fakeporn.7z&lt;/Description&gt; &lt;a href=&#34;https://login.skype.com/login/sso?go=webclient.xmm&amp;amp;docid=0-weu-d2-a958c1f0bec3eaa30bcef8d795c8ff63&#34;&gt;https://login.skype.com/login/sso?go=webclient.xmm&amp;amp;docid=0-weu-d2-a958c1f0bec3eaa30bcef8d795c8ff63&lt;/a&gt;&lt;FileSize v=&#34;750184&#34; /&gt;&lt;OriginalName v=&#34;fakeporn.7z&#34; /&gt;&lt;/URIObject&gt;
</span></span><span style="display:flex;"><span>2016/06/21 11:48:46 EHPT Msgs   Nice pics&lt;ss type=&#34;wink&#34;&gt;;)&lt;/ss&gt;
</span></span></code></pre></div><p>会話の流れからして，<code>EHPT Msgs</code>がこの端末の所持者で社内ネットワークから機密事項である写真とドキュメントを外に送ろうとしているが，ネットワークが監視されているのでどうしようと<code>Linux rul3z</code>に相談をしている感じです．</p>
<p>ネットワークが監視されているということで，TeamViewerをインストールさせてそれ経由でリモート操作をしようとしている感じですね．</p>
<p>TeamViewerは操作される端末側のIDとパスワードを入力することで操作側から端末にリモートでアクセスすることができます．</p>
<p>おそらく，この<code>Linux rul3z</code>のHotmailにそのIDとかパスワードが送信されるのでしょう．たぶん．</p>
<p><code>Linux rul3z</code>はHotmailのIDはSkypeと一緒だと言っているのでメールアドレスは<code>linux-rul3z@hotmail.com</code>でしょう．</p>
<h4 id="skypeから分かったことと推測">Skypeから分かったことと推測<a hidden class="anchor" aria-hidden="true" href="#skypeから分かったことと推測">#</a></h4>
<ul>
<li><code>EHPT Msgs</code>が<code>Linux rul3z</code>に内部ネットワークから外部にドキュメントと写真を送信したいと相談</li>
<li><code>EHPT Msgs</code>のネットワークは監視されている</li>
<li><code>Linux rul3z</code>が<code>EHPT Msgs</code>の端末にアクセスをしてどうにか取得をしようとしている</li>
<li><code>EHPT Msgs</code>の端末にTeamViewerをインストールして<code>Linux rul3z</code>がリモートアクセスをしようとしている</li>
<li>TeamViewerのセットアップが終了したら，<code>Linux rul3z</code>のメールアドレス<code>linux-rul3z@hotmail.com</code>にTeamViewerの認証情報とかを送信しようとしている</li>
</ul>
<h3 id="メール">メール<a hidden class="anchor" aria-hidden="true" href="#メール">#</a></h3>
<p>SkypeでHotmailに送ってくれと言われていたので，メールの証跡を調べる．</p>
<p>PrefetchファイルやUserAssistからOutlookが実行されていたことが分かるので，Outlookのメールを調べる．</p>
<p>Outlookのデータファイルは<code>.pst</code>か<code>.ost</code>の形式で保存されている．</p>
<p>Outlook データ ファイル (.pst および .ost) の概要 - Outlook
<a href="https://support.office.com/ja-jp/article/outlook-%E3%83%87%E3%83%BC%E3%82%BF-%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB-pst-%E3%81%8A%E3%82%88%E3%81%B3-ost-%E3%81%AE%E6%A6%82%E8%A6%81-222eaf92-a995-45d9-bde2-f331f60e2790">https://support.office.com/ja-jp/article/outlook-%E3%83%87%E3%83%BC%E3%82%BF-%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB-pst-%E3%81%8A%E3%82%88%E3%81%B3-ost-%E3%81%AE%E6%A6%82%E8%A6%81-222eaf92-a995-45d9-bde2-f331f60e2790</a></p>
<p>.pst，.ostファイルは以下のパスに保存されているので見る．</p>
<p><code>C:/Users/user/AppData/Local/Microsoft/Outlook/</code></p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015041p:plain" loading="lazy" src="/posts/2018/02/19/20180219015041.png" title="f:id:socketo:20180219015041p:plain"><!-- raw HTML omitted --></p>
<p><code>ehptmsgs@gmail.com.ost</code>というファイルを確認しファイルをExportする．</p>
<p>次にExportした.ostファイルを閲覧する．</p>
<p>あいにく手元に使えるOutlookのライセンスが無いので，何かしらの.ostファイルViewerが必要になる．</p>
<p>はじめに<a href="https://gallery.technet.microsoft.com/office/OST-Viewer-to-Easily-Open-96df653e">FreeOSTViewer</a>を試したが，読み込むことが出来ずに断念．</p>
<p>次にXstReaderを使用．</p>
<p><a href="https://github.com/Dijji/XstReader">https://github.com/Dijji/XstReader</a></p>
<p>Exportした.ostファイルを読み込む</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015110p:plain" loading="lazy" src="/posts/2018/02/19/20180219015110.png" title="f:id:socketo:20180219015110p:plain"><!-- raw HTML omitted --></p>
<p>色々とメールが残っていることを確認．だが，日付あっても時間が表示されていないのでまたまた違うツールを検討．</p>
<p>続いてはPST Walkerの評価版を使用．
<a href="https://pstwalker.com/">https://pstwalker.com/</a></p>
<p>Exportしてきた.ostファイルを開くと見れる．今回は受信した日時，送信した日時も表示されているので大丈夫そう．</p>
<p>評価版なので少し制限があるらしく，一定時間にメールの中身を閲覧する制限があるのでその部分はXstReaderで補っていく．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015131p:plain" loading="lazy" src="/posts/2018/02/19/20180219015131.png" title="f:id:socketo:20180219015131p:plain"><!-- raw HTML omitted --></p>
<p>恐らく時間がローカルのタイムゾーンに合わせられてしまうので，UTCに直すために-9した時間を表示．</p>
<h4 id="メールのタイムライン">メールのタイムライン<a hidden class="anchor" aria-hidden="true" href="#メールのタイムライン">#</a></h4>
<p>メールの中身を見てく．
InboxとSent Mailである程度時系列にまとめる．</p>
<table>
  <thead>
      <tr>
          <th>日時(UTC)</th>
          <th>送信者</th>
          <th>受信者          　</th>
          <th>件名</th>
          <th>メール内容(要約)   　</th>
          <th>添付ファイル</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>2016/06/21 00:53:13</td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td><code>linux-rul3z@hotmail.com</code></td>
          <td>TeamViewer</td>
          <td>TeamViewインストールしたけどいつから話せますか？</td>
          <td>無し</td>
      </tr>
      <tr>
          <td>2016/06/21 00:53:13</td>
          <td><code>linux-rul3z@hotmail.com</code></td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td>RE:TeamViewer</td>
          <td>今仕事中なので終わったらできます．Skypeでpingします</td>
          <td>無し</td>
      </tr>
      <tr>
          <td>2016/06/21 00:57:50</td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td><code>linux-rul3z@hotmail.com</code></td>
          <td>RE:TeamViewer</td>
          <td>了解です</td>
          <td>無し</td>
      </tr>
      <tr>
          <td>2016/06/21 01:00:31</td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td><code>linux-rul3z@hotmail.com</code></td>
          <td>Pics</td>
          <td>このメールに添付した.7zファイルに写真が入ってる．Skype経由でパスワードを渡します</td>
          <td>&ldquo;Pictures.7z&rdquo;</td>
      </tr>
      <tr>
          <td>2016/06/21 01:01:28</td>
          <td><code>linux-rul3z@hotmail.com</code></td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td>RE:Pics</td>
          <td>了解です</td>
          <td>無し</td>
      </tr>
      <tr>
          <td>2016/06/21 11:04:05</td>
          <td><code>linux-rul3z@hotmail.com</code></td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td>DNS Exifl Videos</td>
          <td>DNS Data Exfiltrationに関する動画(YouTubeのリンク)の共有</td>
          <td>無し</td>
      </tr>
      <tr>
          <td>2016/06/21 01:54:21</td>
          <td><code>no-reply@accounts.google.com</code></td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td>New sign-in from Windows</td>
          <td>Googleアカウント新規アクセス</td>
          <td>無し</td>
      </tr>
      <tr>
          <td>2016/06/21 01:57:16</td>
          <td><code>linux-rul3z@hotmail.com</code></td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td>File Extensions</td>
          <td>ファイルを隠すために拡張子を変えることのアドバイス．PDFファイルの拡張子を確認してください</td>
          <td>無し</td>
      </tr>
      <tr>
          <td>2016/06/21 01:57:53</td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td><code>linux-rul3z@hotmail.com</code></td>
          <td>RE:File Extensions</td>
          <td>やってみます．少し待ってください</td>
          <td>無し</td>
      </tr>
      <tr>
          <td>2016/06/21 01:01:17</td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td><code>linux-rul3z@hotmail.com</code></td>
          <td>RE:File Extensions</td>
          <td>これを確認してください添付ファイル</td>
          <td>&ldquo;Config.png&rdquo;</td>
      </tr>
      <tr>
          <td>2016/06/21 11:32:14</td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td><code>linux4rulez@gmail.com</code></td>
          <td>Hangouts?</td>
          <td>あなたからのメール確認しました．Hangoutは繋がりますか？</td>
          <td>無し</td>
      </tr>
      <tr>
          <td>2016/06/21 11:50:24</td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td><code>linux-rul3z@hotmail.com</code>, <code>linux4rulez@gmail.com</code></td>
          <td>Nice Pics</td>
          <td>素敵な写真を添付します．気に入ったら教えてください</td>
          <td>&ldquo;fakeporn.7z&rdquo;</td>
      </tr>
      <tr>
          <td>2016/06/21 11:51:04</td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td><code>linux-rul3z@hotmail.com</code></td>
          <td>RE:DNS Exifl Videos</td>
          <td>動画を保存して見てみますが</td>
          <td>無し</td>
      </tr>
      <tr>
          <td>2016/06/21 11:56:39</td>
          <td><code>linux-rul3z@hotmail.com</code></td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td>RE:DNS Exifl Videos</td>
          <td>それをしないでください．ネットワーク検知されてしまいます</td>
          <td>無し</td>
      </tr>
      <tr>
          <td>2016/06/21 11:57:47</td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td><code>linux-rul3z@hotmail.com</code></td>
          <td>RE:DNS Exifl Videos</td>
          <td>わかりました削除します．それらのフォルダと情報を全て削除します</td>
          <td>無し</td>
      </tr>
      <tr>
          <td>2016/06/21 12:19:33</td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td><code>linux-rul3z@hotmail.com</code>, <code>linux4rulez@gmail.com</code></td>
          <td>Network Design</td>
          <td>ネットワーク設計のサンプルの添付</td>
          <td>&ldquo;home-network-design-networking-for-a-single-family-home-case-house-arkko-1433-x-792.jpg&rdquo;</td>
      </tr>
      <tr>
          <td>2016/06/21 12:20:39</td>
          <td><code>linux4rulez@gmail.com</code></td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td>RE:Network Design</td>
          <td>ネットワーク用のオリジナルプリントを入手してください</td>
          <td>無し</td>
      </tr>
      <tr>
          <td>2016/06/21 12:31:20</td>
          <td><code>linux4rulez@gmail.com</code></td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td>Fwd:Network Design</td>
          <td>&ldquo;RE:Network Design&quot;の転送メール</td>
          <td>無し</td>
      </tr>
      <tr>
          <td>2016/06/21 13:16:00</td>
          <td><code>ehptmsgs@gmail.com</code></td>
          <td><code>linux-rul3z@hotmail.com</code></td>
          <td>Greetings</td>
          <td>Outlookの設定の確認のテストとプロジェクトの終了</td>
          <td>無し</td>
      </tr>
  </tbody>
</table>
<p>メール経由で送信されたファイルは以下の4つのファイル</p>
<ul>
<li>Pictures.7z</li>
<li>Config.jpg</li>
<li>fakeporn.7z</li>
<li>home-network-design-networking-for-a-single-family-home-case-house-arkko-1433-x-792.jpg</li>
</ul>
<p>2016/06/21 01:57:16に受信したメールで言及されているように，添付ファイルの拡張子を偽装したものが&quot;Config.jpg&quot;だと考えられる．</p>
<p>実際にファイルヘッダを見てみるとどう見てもPDFっぽい感じで.jpgでない．
<!-- raw HTML omitted --><img alt="f:id:socketo:20180219015201p:plain" loading="lazy" src="/posts/2018/02/19/20180219015201.png" title="f:id:socketo:20180219015201p:plain"><!-- raw HTML omitted --></p>
<p>拡張子を.jpgから.pdfに変更して閲覧する．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015219p:plain" loading="lazy" src="/posts/2018/02/19/20180219015219.png" title="f:id:socketo:20180219015219p:plain"><!-- raw HTML omitted --></p>
<p>とりあえず&quot;Confidential Docment&quot;と書かれているので恐らく持ち出してはいけない感じのファイルっぽい．</p>
<p>残りのPictures.7zとfakeporn.7zに関してはパスワードがかけられていて今のところ中身は確認することが出来ない．</p>
<p>Pictures.7zに関してはSkype経由でパスワードを送っていることが2016/06/21 01:00:31に受信したメールから分かる．</p>
<p>fakeporn.7zのパスワードに関しては述べられていないが，このファイルが添付されているメールの一つ前にHangoutが出来るかというメールを送っている(2016/06/21 11:32:14)のでHangout経由で送ったのか，それともSkype経由で送ったものかを推測することが出来る．</p>
<p>Skypeのログからパスワードを探したい．</p>
<p>だが，現存するスカイプのログでは2016/06/21/ 00:48:56～2016/06/21 11:48:56が無く，レコード番号も2016/06/21/ 09:48:56の738と2016/06/21 11:48:56の741の間が存在していないことから，パスワード送信部分のメッセージ(739, 740)が削除された可能性がある．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015246p:plain" loading="lazy" src="/posts/2018/02/19/20180219015246.png" title="f:id:socketo:20180219015246p:plain"><!-- raw HTML omitted --></p>
<h4 id="メールから分かったことと推測">メールから分かったことと推測<a hidden class="anchor" aria-hidden="true" href="#メールから分かったことと推測">#</a></h4>
<ul>
<li>
<p>この端末を使用しているユーザのメールアドレスは<code>ehptmsgs@gmail.com</code></p>
</li>
<li>
<p>内部ネットワークから持ち出す際に助言を求めているアカウント<code>Linux rul3z</code>のメールアドレスは<code>linux-rul3z@hotmail.com</code>と<code>linux4rulez@gmail.com</code></p>
</li>
<li>
<p>複数個メールでファイル送信が行われている</p>
<ul>
<li>Pictures.7z : Skypeでパスワードを送信(メール内容より)</li>
<li>Config.jpg : ファイル拡張子を&rdquo;.jpg&quot;に偽装したPDFファイル</li>
<li>fakeporn.7z : パスワード不明</li>
<li>home-network-design-networking-for-a-single-family-home-case-house-arkko-1433-x-792.jpg : ネットワーク構成図(センシティブなものではなさそう(メール内容より))</li>
</ul>
</li>
<li>
<p>DNS Data Exfiltrationの手法をするとネットワークに検知される</p>
</li>
<li>
<p>Google HangoutsをSkypeとメール以外の連絡手段として使用している可能性あり</p>
</li>
</ul>
<h3 id="web履歴">WEB履歴<a hidden class="anchor" aria-hidden="true" href="#web履歴">#</a></h3>
<p>今までのSkype，メールでTeamViewerのインストールやHungoutやYouTubeの動画など確実にWEBブラウザを使用シーンが無数にあったのでWEB履歴を確認する．</p>
<p>Prefetchから，実行されていたブラウザはChrome, Firefox, InternetExplorerの3つだということが分かった．</p>
<h4 id="chrome">Chrome<a hidden class="anchor" aria-hidden="true" href="#chrome">#</a></h4>
<p>Chromeの履歴に対しては以下のツールを使ってみる．</p>
<p>obsidianforensics/hindsight</p>
<p><a href="https://github.com/obsidianforensics/hindsight">https://github.com/obsidianforensics/hindsight</a></p>
<p>Python2.7が必要．</p>
<p>ユーザガイドが丁寧なのでこれに従ってやっていく．</p>
<p><a href="https://github.com/obsidianforensics/hindsight/blob/master/documentation/Hindsight%20User%20Guide%20v1.3.0.pdf">https://github.com/obsidianforensics/hindsight/blob/master/documentation/Hindsight%20User%20Guide%20v1.3.0.pdf</a></p>
<p>スクリプトを実行してブラウザで&rsquo;localhost:8080&rsquo;へアクセスすると使うことが出来る．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015312p:plain" loading="lazy" src="/posts/2018/02/19/20180219015312.png" title="f:id:socketo:20180219015312p:plain"><!-- raw HTML omitted --></p>
<p>対象の端末OSがWindows8.1なので<code>   \userdir\]\AppData\Local\Google\Chrome\User Data\Default</code>をFTK ImagerでExportしてProfile Pathに入力すると以下のように結果が出るので，Save XLSXまたはSave [SQLite DBをクリックして.xlsx形式または.sqlite形式で保存する．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015334p:plain" loading="lazy" src="/posts/2018/02/19/20180219015334.png" title="f:id:socketo:20180219015334p:plain"><!-- raw HTML omitted --></p>
<p>今回はSQLiteDB形式で保存し，DB Browser for SQLiteで中身を見る</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015353p:plain" loading="lazy" src="/posts/2018/02/19/20180219015353.png" title="f:id:socketo:20180219015353p:plain"><!-- raw HTML omitted --></p>
<h4 id="hangouts">Hangouts<a hidden class="anchor" aria-hidden="true" href="#hangouts">#</a></h4>
<p>メールでHangoutsで連絡できるか？と聞いているので，Chromeの履歴からHangoutsの証跡を探さなけれなならない．</p>
<p>Google Hangoutsのフォレンジック関係は，Android端末に対しての言及はあるがPCのChromeからはあまり見当たらないし，まぁ無理な気がする．</p>
<p>Redditでも言及はあるが，しんどそう．</p>
<p>Google hangouts forensics : computerforensics <a href="https://www.reddit.com/r/computerforensics/comments/2631jb/google_hangouts_forensics/">https://www.reddit.com/r/computerforensics/comments/2631jb/google_hangouts_forensics/</a></p>
<p>AndroidのHangoutsについてはまぁありそう．</p>
<p>Google Hangouts analysis - Learning Android Forensics <a href="https://www.packtpub.com/mapt/book/networking_and_servers/9781782174578/7/ch07lvl1sec60/google-hangouts-analysis">https://www.packtpub.com/mapt/book/networking_and_servers/9781782174578/7/ch07lvl1sec60/google-hangouts-analysis</a></p>
<p>なので，WEB履歴から&quot;hangouts.google.com&quot;でフィルタをして恐らくHangoutsを使用していた時間帯というのを絞りたい．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015415p:plain" loading="lazy" src="/posts/2018/02/19/20180219015415.png" title="f:id:socketo:20180219015415p:plain"><!-- raw HTML omitted --></p>
<p>おおまかに以下の時間帯に&quot;hangouts.google.com&quot;にアクセスしていた</p>
<ul>
<li>2016/06/20 23:59:51～2016/06/21 00:00:05</li>
<li>2016/06/21 01:43:32～2016/06/21 01:43:40</li>
<li>2016/06/21 09:14:44～2016/06/21 09:15:16</li>
<li>2016/06/21 10:45:58～2016/06/21 10:46:49</li>
<li>2016/06/21 11:30:35～2016/06/21 11:32:47 ※</li>
<li>2016/06/21 12:22:46～2016/06/21 12:22:48 ※</li>
<li>2016-06-21 12:52:35 ※</li>
<li>2016/06/21 13:19:25 ※</li>
</ul>
<p>メール件名&quot;Hangouts?&ldquo;を送信した時間以降のものに&rdquo;※&ldquo;を表示している．</p>
<p>Hangoutsで相手と連絡をとったのはここのどこかになると推測できる．</p>
<p>正直それ以外は現状よく分からないのでHangoutsはとりあえずここまで．</p>
<h5 id="chrome経由でダウンロードされたファイル">Chrome経由でダウンロードされたファイル<a hidden class="anchor" aria-hidden="true" href="#chrome経由でダウンロードされたファイル">#</a></h5>
<p>timelineテーブルにアクセスのタイプ，日時，URL，タイトル…などのカラムに格納されている．</p>
<p>このタイプの部分に&quot;download&quot;として格納されているものは，Chromeを介してファイルをダウンロードしたものが残っている．</p>
<p>ダウンロードされたファイルは以下のようなものがあった(抜粋)</p>
<ul>
<li>2016-06-20 16:57:34.500 : putty.exe</li>
<li>2016-06-20 16:58:03.044 : DEFCON-22-Zoltan-Balazs-Bypass-firewalls-application-whitelists-in-20-seconds-UPDATED.pdf</li>
<li>2016-06-20 17:52:02.028 : TeamViewer_Setup-vfa.exe</li>
<li>2016-06-20 18:43:57.878 : googledrivesync.exe</li>
<li>2016-06-20 18:44:08.835 : DropboxInstaller.exe</li>
<li>2016-06-21 01:54:19.418 : SkypeSetup.exe</li>
<li>2016-06-21 02:15:24.167 : Wireshark-win64-2.0.4.exe</li>
<li>2016-06-21 02:16:35.660 : 7z1602-x64.exe</li>
<li>2016-06-21 03:45:34.221 : ccsetup519pro.exe</li>
<li>2016-06-21 03:48:23.003 : torbrowser-install-6.0.1_en-US.exe</li>
<li>2016-06-21 03:56:27.140 : bcwipeSetup.exe</li>
<li>2016-06-21 03:57:17.593 : Eraser6.2.0.2971-NoRuntimes.exe</li>
<li>2016-06-21 03:58:38.541 : nmap-7.12-setup.exe</li>
<li>2016-06-21 04:00:20.183 : Hash_Suite_Free_3_4.zip</li>
<li>2016-06-21 04:00:58.367 : burpsuite_free_v1.7.03.jar</li>
<li>2016-06-21 04:01:24.055 : SysinternalsSuite.zip</li>
<li>2016-06-21 04:03:41.022 : python-2.7.11.msi</li>
<li>2016-06-21 04:03:42.545 : python-3.5.1.exe</li>
<li>2016-06-21 04:05:00.071 : odbg110.zip</li>
</ul>
<p>※時間はUTC-7なので+7にしてUTCに変換する必要がある</p>
<h4 id="internetexploler">InternetExploler<a hidden class="anchor" aria-hidden="true" href="#internetexploler">#</a></h4>
<p>IEのWEB履歴を見る．</p>
<p>IE version10以降の閲覧履歴は以下のファイルに保存されているのでこれをFTK ImagerでExportする．</p>
<p><code>C:¥Users¥{Username}¥AppData¥Local¥Microsoft¥Windows¥WebCache. ¥WebCacheV01.dat</code></p>
<p>解析にはブラウザの閲覧履歴を解析するツールBrowsing History Viewを使う．</p>
<p>BrowsingHistoryView - View browsing history of your Web browsers</p>
<p><a href="https://www.nirsoft.net/utils/browsing_history_view.html">https://www.nirsoft.net/utils/browsing_history_view.html</a></p>
<p>ExportしたWebCacheV01.datをメニューから<code>Options</code>-<code>Advanced Options</code>を選択し，<code>Load history from..</code>で<code>Load history from the specified history files</code>から<code>Internet Explorer(Version 10.0/11.0) history files(WebCacheV01.dat)</code>にパスを設定する．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015532p:plain" loading="lazy" src="/posts/2018/02/19/20180219015532.png" title="f:id:socketo:20180219015532p:plain"><!-- raw HTML omitted --></p>
<p>アクセスを見ると，<code>2016/06/21 21:14:39</code>に<code>http://www.teamviewer.com/company/shutdown.aspx?version=11.0.59518</code>があるが，これはTeamViewerを終了した際に表示されるWEBページのようで，おそらくこの時間帯にTeamViewerを終了したのではないかと推測出来る．</p>
<p>WebCacheV01.datがIEでアクセスしたものだけでなく，WindowsのExplolerでアクセスしたファイルについても記録がされている．</p>
<p>今回のログで残っているものは以下の4つ．</p>
<p>ここもローカルのタイムゾーンに合わせられてしまうので，UTCに直すために-9をする必要があるので直した時間を表示．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>file:///C:/Users/Hunter/Pictures/Exfil/dns-exfiltration-using-sqlmap-18-728.jpg      2016/06/21 12:17:39
</span></span><span style="display:flex;"><span>file:///C:/Users/Hunter/Pictures/Exfil/Exfiltration_Diagram.png     2016/06/21 12:17:42
</span></span><span style="display:flex;"><span>file:///C:/Users/Hunter/Documents/home-network-design-networking-for-a-single-family-home-case-house-arkko-1433-x-792.jpg       2016/06/21 12:19:31
</span></span><span style="display:flex;"><span>file:///C:/Users/Hunter/Documents/Welcome.docx      2016/06/21 12:27:37
</span></span></code></pre></div><p><code>Pictures/Exfil</code>下の画像ファイル2つはメールで言及していたDNS Data Exfiltrationについての画像なのでとりあえず機密な画像では無さそう．</p>
<p><code>home-network-design-networking-for-a-single-family-home-case-house-arkko-1433-x-792.jpg</code>は<code>C:\Users\Hunter\Documents\</code>に現存していないが，<code>2016/06/21 12:19:33</code>に送信したメールの添付ファイルが同じ名前で恐らくこのファイルでないかと推測が出来る．</p>
<p>裏付けとして，USNJurnlで調べる．</p>
<p>冒頭でUSNAnalyticsで出力した<code>usn_analytics_records-20160621T081446.csv</code>でファイルの名前でフィルタをする．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015547p:plain" loading="lazy" src="/posts/2018/02/19/20180219015547.png" title="f:id:socketo:20180219015547p:plain"><!-- raw HTML omitted --></p>
<p>2016/06/21 12:22:20に<code>Hunter\Documents\</code>から<code>Hunter\Dropbox\</code>へ移動していることが分かる．</p>
<p>とりあえずメールに添付されていたファイルと，Dropboxへ移動したファイルが一致していることを確認する．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015606p:plain" loading="lazy" src="/posts/2018/02/19/20180219015606.png" title="f:id:socketo:20180219015606p:plain"><!-- raw HTML omitted --></p>
<p>MD5ハッシュ値が一致していることを確認．メールで送信されたネットワーク図がDropboxにアップロードされていた画像と同じことを確認した．</p>
<p><code>Welcome.docx</code>は<code>C:\Users\Hunter\Documents\</code>に現存している普通のドキュメントファイルで開くことが出来た．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015625p:plain" loading="lazy" src="/posts/2018/02/19/20180219015625.png" title="f:id:socketo:20180219015625p:plain"><!-- raw HTML omitted --></p>
<p>重要な情報を書くために使用する文書だと記述があるので，まぁ重要そうなドキュメントっぽい．</p>
<h4 id="torbrowser">TorBrowser<a hidden class="anchor" aria-hidden="true" href="#torbrowser">#</a></h4>
<p>Chromeのダウンロードや，Prefetch，UserAssistを見ているとTor Browserを実行していることが分かる．</p>
<p>分かりやすく<code>C:\Users\Hunter\Desktop\Tor Browser</code>というディレクトリがあるので見ていく．</p>
<p>Tor BrowserはFirefoxをベースにされていて，今回は<code>C:\Users\Hunter\Desktop\Tor Browser</code>下にあるFirefox.exeを使っているらしい．
なので，Prefetch的には<code>FIREFOX.EXE-FB5E902D.pf</code>として残っている．</p>
<p>Prefetchのデータ部分を見ると，参照しているのがデスクトップのTor Browser下のファイルということでこれがTor Browserだということが分かる．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015646p:plain" loading="lazy" src="/posts/2018/02/19/20180219015646.png" title="f:id:socketo:20180219015646p:plain"><!-- raw HTML omitted --></p>
<p>Tor BrowserのフォレンジックについてはSANSが資料を出していたので少し見た．</p>
<p>Tor Forensics on Windows OS(PDF)</p>
<p><a href="https://digital-forensics.sans.org/summit-archives/dfirprague14/Tor_Forensics_On_Windows_OS_Mattia_Epifani.pdf">https://digital-forensics.sans.org/summit-archives/dfirprague14/Tor_Forensics_On_Windows_OS_Mattia_Epifani.pdf</a></p>
<p><code>pagefile.sys</code>にTor Browserを実行，または介してアクセスした際に残る特徴的なキーワードが以下の7つらしい．</p>
<ul>
<li>HTTP-memory-only-PB</li>
<li>Torproject</li>
<li>Tor</li>
<li>Torrc</li>
<li>Geoip</li>
<li>Torbutton</li>
<li>Tor-launcher</li>
</ul>
<p>中でもメモリ上には<code>HTTP-memory-only-PB</code>の文字列の後にはTor Browserを介してアクセスしたURLが記載されるらしい．
pagefile.sysの中を上のキーワードで検索をしたがそれっぽいのは無し．断念．</p>
<p>気休め程度にTor経由で送受信されたデータ量を確認する．</p>
<p>SRUMを確認する．</p>
<p>SRUMはWindows8から導入された，System Resource Usage Monitorの略称のシステム．</p>
<p>Windows上で動いていたサービスやアプリケーション，ネットワーク接続の活動のデータを保持している．</p>
<p>詳しい説明は以下のSRUM forensics．</p>
<p>SRUM forensics</p>
<p><a href="https://www.sans.org/summit-archives/file/summit-archive-1492184583.pdf">https://www.sans.org/summit-archives/file/summit-archive-1492184583.pdf</a></p>
<p><code>C:\Windows\System32\sru\SRUDB.dat</code>をFTKImagerでExportする．</p>
<p>ネットワーク接続を確認するのにはNetworkUsageViewを使用する．</p>
<p>NetworkUsageView <a href="https://www.nirsoft.net/utils/network_usage_view.html">https://www.nirsoft.net/utils/network_usage_view.html</a></p>
<p>これにExportしたSRUDB.datを読み込ませる．</p>
<p>アプリケーションやシステムごとにネットワーク接続の送信/受信のデータ量を見ることができる．</p>
<p>tor.exeがは672,648bytes送信，5,613,506bytes受信となっている．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015714p:plain" loading="lazy" src="/posts/2018/02/19/20180219015714.png" title="f:id:socketo:20180219015714p:plain"><!-- raw HTML omitted --></p>
<p>そんなに大きな通信は行われなかったということは分かる．</p>
<h3 id="teamviewer">TeamViewer<a hidden class="anchor" aria-hidden="true" href="#teamviewer">#</a></h3>
<p>Skype，メール，WEB履歴，PrefetchからTeamViewerが使用されていたことが分かっているので，TeamViewerについて見ていく．</p>
<p>TeamViewerのフォレンジックについてのドキュメントがあったりするので見る．</p>
<p>TeamViewer Forensics - Champlain College(PDF)</p>
<p><a href="https://www.champlain.edu/Documents/LCDI/archive/Team-Viewer-Forensics.pdf">https://www.champlain.edu/Documents/LCDI/archive/Team-Viewer-Forensics.pdf</a></p>
<p>サポート詐欺や不正なログインの際に使用される事例が増えているということで以下のような記事もあったので参考．</p>
<p>TeamViewerに気をつけましょう | セキュリティ対策のラック</p>
<p><a href="https://www.lac.co.jp/lacwatch/people/20160606_000357.html">https://www.lac.co.jp/lacwatch/people/20160606_000357.html</a></p>
<p>TeamViewerのログ関係のファイルは<code>C:\Program Files (x86)\TeamViewer</code>と<code>C:\Users\{Username}\AppData\Roaming\TeamViewer</code>にある．</p>
<p>今回見るべきログは次の2つくらいっぽい</p>
<ul>
<li>C:\Program Files (x86)\TeamViewer\Connections_incoming.txt</li>
<li>C:\Program Files (x86)\TeamViewer\TeamViewer11_Logfile.log</li>
</ul>
<p><code>Connections_incoming.txt</code>はリモートログインされたセッションを記録しています．</p>
<p>ログはUTCで記録されている．以下のログでは<code>2016/06/21 12:05:30</code>～<code>2016/06/21 12:14:29</code>に一度接続されていることが確認出来る．</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>547298337    PSUT1   21-06-2016 12:05:30 21-06-2016 12:14:29 Hunter  RemoteControl   {DFB7FCA2-0F07-4468-BE01-67D73CD83B3A}
</span></span></code></pre></div><p><code>TeamViewer11_Logfile.log</code>はシステム的なログが残っているが，いい感じのものは残っていなかった．</p>
<p>上の<code>Team-Viewer-Forensics.pdf</code>を読むと分かるが，リモートされる端末(被害端末)ではファイル転送のログは残らず，リモートする端末の方のログで一時的に残ることから，今回の被害端末上でファイルが転送されたという証跡は確認することが出来ない．</p>
<h4 id="teamviewerから分かったこと">TeamViewerから分かったこと<a hidden class="anchor" aria-hidden="true" href="#teamviewerから分かったこと">#</a></h4>
<ul>
<li>2016/06/21 12:05:30～2016/06/21 12:14:29の間，リモートで操作されていた</li>
</ul>
<h4 id="teamviewerでの遠隔操作時の動き">TeamViewerでの遠隔操作時の動き<a hidden class="anchor" aria-hidden="true" href="#teamviewerでの遠隔操作時の動き">#</a></h4>
<p>上記で分かったTeamViewerの接続時間で何をやっていたのかを調べる必要があるのでとりあえずやる．</p>
<h5 id="prefetchから">Prefetchから<a hidden class="anchor" aria-hidden="true" href="#prefetchから">#</a></h5>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015759p:plain" loading="lazy" src="/posts/2018/02/19/20180219015759.png" title="f:id:socketo:20180219015759p:plain"><!-- raw HTML omitted -->
Prefetchを見ると，その時間に<code>zenmap</code>，<code>nmap</code>が実行されていることが分かる．</p>
<p>zenmapはポートスキャンツールであるnmapのGUI版．</p>
<p>どこかしらにポートスキャンをしたと考えられる．</p>
<p>USNJrnlからこの時間内に作成された<code>C:\Users\Hunter\.zenmap\recent_scans.txt</code>を見てみると，以下のファイルパスが書かれている．</p>
<p><code>C:\Users\Hunter\Desktop\nmapscan.xml</code></p>
<p>NMAPに関係ありそうなファイルなので見てみる．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015817p:plain" loading="lazy" src="/posts/2018/02/19/20180219015817.png" title="f:id:socketo:20180219015817p:plain"><!-- raw HTML omitted --></p>
<p>nmapのスキャンログの様子．</p>
<p><code>scanme.nmap.org(45.33.32.156)</code>へポートスキャンをしているログを確認することができた．</p>
<h3 id="cloudストレージ">Cloudストレージ<a hidden class="anchor" aria-hidden="true" href="#cloudストレージ">#</a></h3>
<p>今回のこの端末にはDropboxとGoogleDriveが入っていた．</p>
<p>両方共，インストールした後にそのディレクトリにファイルを置いてファイルの設定を変更すると他者と共有することが出来る．</p>
<p>普通に機密情報とかだとクラウドストレージにアップするだけでも怒られが発生しそうなので，その辺を見る．</p>
<p>Cloud Storage Forensics(PDF)</p>
<p><a href="https://digital-forensics.sans.org/summit-archives/Prague_Summit/Cloud_Storage_Forensics_Mattia_Eppifani.pdf">https://digital-forensics.sans.org/summit-archives/Prague_Summit/Cloud_Storage_Forensics_Mattia_Eppifani.pdf</a></p>
<p>有償ツールを使ったりメモリを使ったりしていたので，今回はUSNJrnl上で<code>C:\Users\Hunter\Dropbox</code>ディレクトリと<code>C:\Users\Hunter\Google Drive</code>を見てファイルの流れを確認する．</p>
<p>各アップロードされたファイル</p>
<ul>
<li>Dropbox</li>
<li>Get Started with Dropbox.pdf : Dropboxの始め方の説明</li>
<li>Accounts.txt : 使用しているアカウント一覧(Gmail, Skype, TeamViewer, GoogleDrive, Dropbox)</li>
<li>Info/TechnialInfo.txt : 2016/06/21 11:04:05に受信したメールのDNS Data ExfiltrationのYouTube動画リンク集</li>
<li>home-network-design-networking-for-a-single-family-home-case-house-arkko-1433-x-792.jpg</li>
<li>Outlook/backup.pst : メールのバックアップファイル</li>
<li>Pictures.7z : メールで送信したアーカイブファイル</li>
</ul>
<ul>
<li>
<p>Google Drive</p>
<ul>
<li>Pyhton and the Army Knife (Recoverd).gslides : Googleスライド(URLが中に入っているが限定公開の模様)</li>
<li>Getting Started : Google Driveの公式の開始pdf</li>
<li>tools.txt : 2016/06/21 11:04:05に受信したメールのDNS Data ExfiltrationのYouTube動画リンク集</li>
<li>Accounts.txt : このアカウントに居ストールするアプリケーションたち(Chrome, Skype, Outlook,など)</li>
<li>proposal.pdf : 4orensics – Training and Consultation Servicesについて(宣伝)</li>
<li>FTK-Imager.zip</li>
</ul>
</li>
</ul>
<h3 id="pictures7zとfakeporn7zの中身を探す">Pictures.7zとfakeporn.7zの中身を探す<a hidden class="anchor" aria-hidden="true" href="#pictures7zとfakeporn7zの中身を探す">#</a></h3>
<h4 id="pictures7z">Pictures.7z<a hidden class="anchor" aria-hidden="true" href="#pictures7z">#</a></h4>
<p>USNJrnlで<code>Pictures.7z</code>をフィルタすると，初回登場が.lnkファイルとなる．</p>
<p>ちなみにこのLNKファイルは削除されているため，どこを参照したものなのかが不明．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015847p:plain" loading="lazy" src="/posts/2018/02/19/20180219015847.png" title="f:id:socketo:20180219015847p:plain"><!-- raw HTML omitted --></p>
<p>CREATEされたパスがDropboxになっていることから，このファイルはDropbox経由で取得したものの可能性もあると考えることが出来る．</p>
<h4 id="fakeporn7z">fakeporn.7z<a hidden class="anchor" aria-hidden="true" href="#fakeporn7z">#</a></h4>
<p>USNJrnlで&quot;fakeporn&quot;で検索をする．</p>
<p><code>2016/06/21 11:45:03に</code>C:\Users\Hunter\Pictures`下にfakepornというディレクトリが作られ，そのディレクトリへ.画像ファイルが保存されていることが分かる．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219015908p:plain" loading="lazy" src="/posts/2018/02/19/20180219015908.png" title="f:id:socketo:20180219015908p:plain"><!-- raw HTML omitted --></p>
<p>ChromeのWEB履歴内で保存パスを<code>C:\Users\hunter\Pictures\fakeporn</code>で検索をするとファイルが複数ヒットする．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219020001p:plain" loading="lazy" src="/posts/2018/02/19/20180219020001.png" title="f:id:socketo:20180219020001p:plain"><!-- raw HTML omitted --></p>
<p>そのURLを見ていくと，可愛らしい動物の写真が出て来る．</p>
<p>恐らく，fakeporn.7zの中身はそれらの画像だということを推測．</p>
<p>そして後にfakeporn.7zは2016/06/21 12:01:07に<code>mofygdvh.mcp</code>へリネームしたことをUSNJrnlで確認した．</p>
<h3 id="filecarving">FileCarving<a hidden class="anchor" aria-hidden="true" href="#filecarving">#</a></h3>
<p>最初の要件的にファイルカービングを行う必要があるっぽいのでやる．</p>
<p>カービングはファイルのヘッダ/フッタを探しだして2つの間のブロックを切り取ってファイル復元をするものらしい．</p>
<p>断片とかをつなぎ合わせていい感じにファイルを復元するもので，コンセプトとか説明は以下を読んだ方が良いっぽい．</p>
<p>File Carving - ForensicsWiki</p>
<p><a href="http://forensicswiki.org/wiki/File_Carving">http://forensicswiki.org/wiki/File_Carving</a></p>
<p>Data Carving Concepts(pdf)</p>
<p><a href="https://www.sans.org/reading-room/whitepapers/forensics/data-carving-concepts-32969">https://www.sans.org/reading-room/whitepapers/forensics/data-carving-concepts-32969</a></p>
<p>今回はSIFT Workstationに入っているforemostを使用する．他にもcarvingツールは色々あるっぽいので今度見てみる．</p>
<p>Foremost</p>
<p><a href="http://foremost.sourceforge.net/">http://foremost.sourceforge.net/</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>[socketo@siftworkstation:/vagrant_data/ashemery/Challenge02]$ foremost -t jpg,png,gif,doc,xls,pdf -i 4orensics03.001 -o ./output
</span></span><span style="display:flex;"><span>Processing: 4orensics03.001
</span></span><span style="display:flex;"><span>*********************************************************************|
</span></span></code></pre></div><p>結果．指定していない拡張子も取られているので何かおかしい．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219020029p:plain" loading="lazy" src="/posts/2018/02/19/20180219020029.png" title="f:id:socketo:20180219020029p:plain"><!-- raw HTML omitted --></p>
<p>実際にカービングして出力されたファイルを見る．</p>
<p>fakeporn.7zに入っていたであろうと推測された動物の画像が復元されていることを確認することが出来た．</p>
<p><!-- raw HTML omitted --><img alt="f:id:socketo:20180219020053p:plain" loading="lazy" src="/posts/2018/02/19/20180219020053.png" title="f:id:socketo:20180219020053p:plain"><!-- raw HTML omitted --></p>
<p>ノイズがかなりあるので，その点をどうにかしないといけなさそう．</p>
<h2 id="timeline">TimeLine<a hidden class="anchor" aria-hidden="true" href="#timeline">#</a></h2>
<p>とりあえずまとめ．</p>
<p>何かを見落としている気がするので適宜訂正をしていきますのでゆるしてください．</p>
<table>
  <thead>
      <tr>
          <th>日時(UTC)</th>
          <th>事象</th>
          <th>ソース        　</th>
          <th>備考         　</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>2016/06/21 00:36:56</td>
          <td>EHPT MsgsがLinux rul3zへSkypeで内部情報の漏洩の補助の依頼</td>
          <td>Skype log</td>
          <td></td>
      </tr>
      <tr>
          <td>2016/06/21 00:52:02</td>
          <td>TeamViewerのインストーラをダウンロード</td>
          <td>WEB履歴(Chrome), USNJurnl</td>
          <td></td>
      </tr>
      <tr>
          <td>2016/06/21 01:00:31</td>
          <td><code>ehptmsgs@gmail.com</code>    から<code>linux-rul3z@hotmail.com</code>へ添付ファイル&quot;Pictures.7z&quot;を送信</td>
          <td>Outlookメール</td>
          <td></td>
      </tr>
      <tr>
          <td>2016/06/21 01:00:??</td>
          <td>EHPT MsgsからLinux rul3zへ&quot;Pictures.7z&quot;のパスワードをSkype経由で送信</td>
          <td>メールの内容</td>
          <td>推測:Skypeのメッセージが削除された可能性あり</td>
      </tr>
      <tr>
          <td>2016/06/21 01:01:17</td>
          <td><code>ehptmsgs@gmail.com</code>から<code>linux-rul3z@hotmail.com</code>へ拡張子を偽装したPDF機密ファイル&quot;Config.png&quot;を送信</td>
          <td>Outlookメール</td>
          <td></td>
      </tr>
      <tr>
          <td>2016/06/21 10:51:21</td>
          <td>TorBrowserのインストール</td>
          <td>Prefetch</td>
          <td>実際のTor実行はFirefox.exe</td>
      </tr>
      <tr>
          <td>2016/06/21 10:54:03</td>
          <td>TorBrowserの実行</td>
          <td>Prefetch</td>
          <td>何かしらの匿名通信</td>
      </tr>
      <tr>
          <td>2016/06/21 11:06:44</td>
          <td>Hash Suite Freeの実行</td>
          <td>UserAssist, Prefetch</td>
          <td>ハッシュからのパスワードの解析</td>
      </tr>
      <tr>
          <td>2016/06/21 11:19:41</td>
          <td>Pythonの実行</td>
          <td>UserAssist, Prefetch</td>
          <td>何かしらのスクリプトが実行された？</td>
      </tr>
      <tr>
          <td>2016/06/21 11:50:24</td>
          <td><code>ehptmsgs@gmail.com</code>から<code>linux-rul3z@hotmail.com</code>, <code>linux4rulez@gmail.com</code>へ&quot;fakeporn.7z&quot;を送信</td>
          <td>Outlookメール</td>
          <td>動物の写真集</td>
      </tr>
      <tr>
          <td>2016/06/21 12:02:35</td>
          <td>BCWipeの実行</td>
          <td>UserAssist, Prefetch</td>
          <td>証跡の削除</td>
      </tr>
      <tr>
          <td>2016/06/21 12:05:30</td>
          <td>TeamViewerでの遠隔操作開始</td>
          <td>TeamViewerログ</td>
          <td></td>
      </tr>
      <tr>
          <td>2016/06/21 12:08:14</td>
          <td>Zenmapの実行．ポートスキャンの開始</td>
          <td>Prefetch</td>
          <td>45.33.32.156へポートスキャン</td>
      </tr>
      <tr>
          <td>2016/06/21 12:13:15</td>
          <td>ポートスキャンの実行結果nmapscan.xmlを保存</td>
          <td>USNJrnl</td>
          <td></td>
      </tr>
      <tr>
          <td>2016/06/21 12:14:29</td>
          <td>TeamViewerでの遠隔操終了</td>
          <td>TeamViewerログ</td>
          <td></td>
      </tr>
      <tr>
          <td>2016/06/21 12:19:33</td>
          <td><code>ehptmsgs@gmail.com</code>から<code>linux-rul3z@hotmail.com</code>, <code>linux4rulez@gmail.com</code>へネットワ画像の&quot;home-network-design-networking-for-a-single-family-home-case-house-arkko-1433-x-792.jpg&quot;の送信</td>
          <td>Outlookメール</td>
          <td></td>
      </tr>
      <tr>
          <td>2016/06/21 12:28:08</td>
          <td>CCleanerの実行</td>
          <td>UserAssist, Prefetch</td>
          <td>証跡の削除</td>
      </tr>
      <tr>
          <td>2016/06/21 13:05:19</td>
          <td>nmapscan.xmlを参照</td>
          <td>USNJrnl, LNK</td>
          <td></td>
      </tr>
      <tr>
          <td>2016/06/21 13:16:00</td>
          <td>プロジェクトの終了</td>
          <td>メール内容</td>
          <td></td>
      </tr>
  </tbody>
</table>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://socketo.github.io/tags/forensics/">Forensics</a></li>
    </ul>

<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Digital Forensic Challenge #2 - User Policy Violation Case Write up on x"
            href="https://x.com/intent/tweet/?text=Digital%20Forensic%20Challenge%20%232%20-%20User%20Policy%20Violation%20Case%20Write%20up&amp;url=https%3a%2f%2fsocketo.github.io%2fposts%2f2018%2f02%2f19%2f&amp;hashtags=Forensics">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Digital Forensic Challenge #2 - User Policy Violation Case Write up on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsocketo.github.io%2fposts%2f2018%2f02%2f19%2f&amp;title=Digital%20Forensic%20Challenge%20%232%20-%20User%20Policy%20Violation%20Case%20Write%20up&amp;summary=Digital%20Forensic%20Challenge%20%232%20-%20User%20Policy%20Violation%20Case%20Write%20up&amp;source=https%3a%2f%2fsocketo.github.io%2fposts%2f2018%2f02%2f19%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Digital Forensic Challenge #2 - User Policy Violation Case Write up on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fsocketo.github.io%2fposts%2f2018%2f02%2f19%2f&title=Digital%20Forensic%20Challenge%20%232%20-%20User%20Policy%20Violation%20Case%20Write%20up">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Digital Forensic Challenge #2 - User Policy Violation Case Write up on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsocketo.github.io%2fposts%2f2018%2f02%2f19%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Digital Forensic Challenge #2 - User Policy Violation Case Write up on whatsapp"
            href="https://api.whatsapp.com/send?text=Digital%20Forensic%20Challenge%20%232%20-%20User%20Policy%20Violation%20Case%20Write%20up%20-%20https%3a%2f%2fsocketo.github.io%2fposts%2f2018%2f02%2f19%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Digital Forensic Challenge #2 - User Policy Violation Case Write up on telegram"
            href="https://telegram.me/share/url?text=Digital%20Forensic%20Challenge%20%232%20-%20User%20Policy%20Violation%20Case%20Write%20up&amp;url=https%3a%2f%2fsocketo.github.io%2fposts%2f2018%2f02%2f19%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Digital Forensic Challenge #2 - User Policy Violation Case Write up on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Digital%20Forensic%20Challenge%20%232%20-%20User%20Policy%20Violation%20Case%20Write%20up&u=https%3a%2f%2fsocketo.github.io%2fposts%2f2018%2f02%2f19%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://socketo.github.io/">socketo.github.io</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
